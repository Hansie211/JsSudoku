"use strict";(globalThis["webpackChunkjs_sudoku"]=globalThis["webpackChunkjs_sudoku"]||[]).push([[677],{83457:(e,t,s)=>{s.d(t,{Z:()=>o,b:()=>n});var i=s(38761),l=s.n(i),a=s(63703);class n{constructor(e,t,s,i){l()(this,"getState",void 0),l()(this,"setState",void 0),l()(this,"setDefault",void 0),l()(this,"key",void 0),this.key=e,this.getState=t,this.setState=s,this.setDefault=i}}class o{save(){const e={};this.states.forEach((t=>{const s=t.key,i=t.getState();e[s]=JSON.stringify(i)})),a.Z.set(this.storageKey,e)}load(){const e=a.Z.getItem(this.storageKey)??{};this.states.forEach((t=>{const s=t.key;try{const i=JSON.parse(e[s]);t.setState(i)}catch(i){t.setDefault()}}))}constructor(e){l()(this,"states",void 0),l()(this,"storageKey",void 0),this.storageKey=e,this.states=[]}}},10098:(e,t,s)=>{s.d(t,{F:()=>r});s(69665);var i=s(81809),l=s(60499),a=s(59835);const n=JSON.parse('{"cb":0,"G1":4,"OD":0}');var o=s(83457);const r=(0,i.Q_)("settings",(()=>{const e={showErrors:(0,l.iH)(void 0),showTime:(0,l.iH)(void 0),showHints:(0,l.iH)(void 0)},t=new o.Z;Object.keys(e).forEach((s=>{t.states.push(new o.b(s,(()=>e[s].value),(t=>e[s].value=t),(()=>e[s].value=!0)))})),t.load(),Object.keys(e).forEach((s=>(0,a.YP)(e[s],(()=>t.save()))));const s=`v${n.cb}.${n.G1}.${n.OD}`;return{...e,version:s}}))},10677:(e,t,s)=>{s.r(t),s.d(t,{default:()=>os});var i=s(59835),l=s(86970),a=s(61957);const n={style:{padding:"10px"}},o={id:"bottom-bar",class:"flex column full-width"},r={id:"info-bar",class:"flex row full-width q-px-sm"},u={class:"text-caption q-mr-sm flex flex-center"},c={class:"text-caption flex-center"},d={id:"action-bar",class:"full-width"},h={id:"mode-bar",class:"row q-pa-sm"};function v(e,t,s,v,m,p){const g=(0,i.up)("sudoku-board"),f=(0,i.up)("q-space"),y=(0,i.up)("difficulty-rating"),w=(0,i.up)("q-btn"),S=(0,i.up)("q-toggle"),C=(0,i.up)("number-bar"),_=(0,i.up)("q-page");return e.gameState.puzzle?((0,i.wg)(),(0,i.j4)(_,{key:0,id:"page"},{default:(0,i.w5)((()=>[(0,i._)("div",n,[((0,i.wg)(),(0,i.j4)(g,{ref:"sudoku",puzzle:e.gameState.puzzle,key:e.renderKey,size:"4.7vw",onCellSelected:e.cellSelected},null,8,["puzzle","onCellSelected"]))]),(0,i._)("div",o,[(0,i._)("div",r,[(0,i.wy)((0,i._)("div",null,(0,l.zw)(e.puzzleTime),513),[[a.F8,e.settings.showTime]]),(0,i.Wm)(f),(0,i._)("div",u,[(0,i.Wm)(y,{level:e.gameDifficulty.level},null,8,["level"])]),(0,i._)("div",c,"Hints "+(0,l.zw)(e.gameState.hintCount),1)]),(0,i._)("div",d,[(0,i._)("div",h,[(0,i.Wm)(w,{icon:"settings",round:"",flat:"",size:"md",onClick:e.showSettings},null,8,["onClick"]),(0,i.Wm)(f),(0,i.Wm)(w,{icon:"undo",flat:"",round:"",size:"md",onClick:e.undo},null,8,["onClick"]),(0,i.wy)((0,i.Wm)(w,{icon:"tips_and_updates",flat:"",round:"",size:"md",onClick:e.hint},null,8,["onClick"]),[[a.F8,e.settings.showHints]]),(0,i.Wm)(S,{modelValue:e.noteMode,"onUpdate:modelValue":t[0]||(t[0]=t=>e.noteMode=t),icon:"edit",color:"positive"},null,8,["modelValue"]),(0,i.Wm)(w,{icon:"backspace",flat:"",round:"",size:"md",onClick:e.clearCell},null,8,["onClick"])]),(0,i.Wm)(C,{size:9,onClick:e.placeNumber,activeNumbers:e.activeNumbers},null,8,["onClick","activeNumbers"])])])])),_:1})):(0,i.kq)("",!0)}s(69665);const m={class:"text-h6"},p={id:"board"};function g(e,t,s,a,n,o){const r=(0,i.up)("sudoku-cell");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("div",m,"Sudoku #"+(0,l.zw)(e.puzzle.seed),1),(0,i._)("div",p,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.boardSize,((t,s)=>((0,i.wg)(),(0,i.iD)("div",{key:s,class:"square"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.getSquareCells(s),(t=>((0,i.wg)(),(0,i.j4)(r,{key:t.id,puzzle:e.puzzle,cell:t,isRowSelected:e.selectedCell?.row.index===t.row.index,isColumnSelected:e.selectedCell?.column.index===t.column.index,isSquareSelected:e.selectedCell?.square.index===t.square.index,isSelected:e.selectedCellId===t.id,isValueSelected:e.selectedCell?.hasValue()&&e.selectedCell?.value===t.value,onSelect:()=>e.onSelectCell(t.id),size:e.size},null,8,["puzzle","cell","isRowSelected","isColumnSelected","isSquareSelected","isSelected","isValueSelected","onSelect","size"])))),128))])))),128))])])}var f=s(727),y=s.n(f),w=s(75105),S=s.n(w),C=s(10357),_=s.n(C),x=s(42768),z=s.n(x),k=s(38761),b=s.n(k),E=s(33782),q=s.n(E);class Z{static getId(){var e;return q()(Z,Z,I,(e=y()(Z,Z,I),++e))}}var I={writable:!0,value:0};function N(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296}}var M=new WeakMap,B=new WeakMap;class V{get seed(){return z()(this,M)}next(){return z()(this,B).call(this)}constructor(e,t){S()(this,M,{writable:!0,value:void 0}),S()(this,B,{writable:!0,value:void 0}),void 0===e&&(e=Math.floor(4294967296*Math.random())),_()(this,M,e);const s=3735928559*e%4294967296,i=t||N;_()(this,B,i(s))}}function D(e,t,s){const i=e[t];e[t]=e[s],e[s]=i}function W(e,t){for(var s=0;s<e.length;s++){const i=Math.floor(t.next()*e.length);D(e,s,i)}}s(6822);class H{get(e){return void 0!==this.data[e]?this.data[e]:this.parent?this.parent.get(e):void 0}set(e,t){if(void 0===t)throw new Error("UNDEF?");this.data[e]=t}clone(){const e=new H(this.size);return e.parent=this,e}constructor(e){b()(this,"parent",void 0),b()(this,"data",void 0),b()(this,"size",void 0),this.id=Z.getId(),this.parent=null,this.data=[],this.size=e}}class L{static getValue(e,t,s){const[i,l]=t.get(s);return e.getCell(i,l)}static setValue(e,t,s,i){const[l,a]=t.get(s);e.setCell(l,a,i)}static isValid(e,t){const s=[];for(var i=0;i<R.SIZE;i++){const l=L.getValue(e,t,i);if(!l)return!1;const a=l-1;if(void 0!==s[a])return!1;s[a]=!0}return!0}static includesValue(e,t,s){for(var i=0;i<R.SIZE;i++){const l=L.getValue(e,t,i);if(l===s)return!0}return!1}get(e){}constructor(e){b()(this,"index",void 0),this.id=Z.getId(),this.index=e}}class O extends L{constructor(...e){super(...e),b()(this,"type","col")}get(e){const t=this.index,s=e;return[t,s]}}class U extends L{constructor(...e){super(...e),b()(this,"type","row")}get(e){const t=e,s=this.index;return[t,s]}}var Q=new WeakMap,$=new WeakMap;class A extends L{get(e){const t=e%R.BASE_NUMBER,s=Math.floor(e/R.BASE_NUMBER),i=z()(this,Q)+t,l=z()(this,$)+s;return[i,l]}constructor(e){super(e),b()(this,"type","square"),S()(this,Q,{writable:!0,value:void 0}),S()(this,$,{writable:!0,value:void 0}),_()(this,Q,this.index%R.BASE_NUMBER*R.BASE_NUMBER),_()(this,$,Math.floor(this.index/R.BASE_NUMBER)*R.BASE_NUMBER)}}class R{static get CELL_COUNT(){return R.SIZE*R.SIZE}static get SIZE(){return R.BASE_NUMBER*R.BASE_NUMBER}static get BASE_NUMBER(){return 3}static get rows(){return y()(this,R,T)}static get columns(){return y()(this,R,j)}static get squares(){return y()(this,R,K)}static getRow(e,t){return R.rows[t]}static getColumn(e,t){return R.columns[e]}static getSquare(e,t){const s=Math.floor(e/R.BASE_NUMBER),i=Math.floor(t/R.BASE_NUMBER),l=s+i*R.BASE_NUMBER;return R.squares[l]}}var T={writable:!0,value:Array(R.SIZE).fill(null).map(((e,t)=>new U(t)))},j={writable:!0,value:Array(R.SIZE).fill(null).map(((e,t)=>new O(t)))},K={writable:!0,value:Array(R.SIZE).fill(null).map(((e,t)=>new A(t)))};class F{static randomSkeleton(e){const t=new F,s=[0,4,8];for(var i=0;i<s.length;i++){const a=R.squares[s[i]],n=[...Array(R.SIZE).keys()];W(n,e);for(var l=0;l<R.SIZE;l++)L.setValue(t,a,l,n[l])}return t}getCell(e,t){return this.cells.get(e*R.SIZE+t)??0}setCell(e,t,s){return this.cells.set(e*R.SIZE+t,s)}clone(){const e=new F;return e.cells=this.cells.clone(),e}duplicate(){const e=new F;for(var t=0;t<R.CELL_COUNT;t++){const s=this.cells.get(t);e.cells.set(t,s)}return e}import(e){this.cells=e.cells}isFinished(){for(var e=0;e<R.CELL_COUNT;e++)if(!this.cells.get(e))return!1;return!0}isValid(){for(var e=0;e<R.SIZE;e++){const t=[R.rows[e],R.columns[e],R.squares[e]],s=t.reduce(((e,t)=>e&&L.isValid(this,t)),!0);if(!s)return!1}return!0}print(){for(var e=0;e<R.SIZE;e++){R.rows[e];for(var t=e+": ",s=0;s<R.SIZE;s++){const i=this.getCell(s,e).toString();t+=i}console.log(t)}console.log("\n\n")}constructor(){b()(this,"cells",void 0),this.id=Z.getId(),this.cells=new H(R.CELL_COUNT)}}var Y=s(79559),P=s.n(Y),G=(s(46727),s(60499));class J{get x(){return this._x}get y(){return this._y}constructor(e,t){b()(this,"_x",void 0),b()(this,"_y",void 0),this._x=e,this._y=t}}class X{hasValue(e){return this.values.includes(e)}addValue(e){this.hasValue(e)||this.values.push(e)}removeValue(e){const t=this.values.indexOf(e);t<0||this.values.splice(t,1)}swapValue(e){this.hasValue(e)?this.removeValue(e):this.addValue(e)}clear(){this.values.length=0}set(e){this.values.length=0,e.forEach((e=>this.values.push(e)))}constructor(){b()(this,"values",void 0),this.values=(0,G.qj)([])}}class ee{get position(){return this._position}get isStatic(){return this._isStatic}get row(){return this._row}get column(){return this._column}get square(){return this._square}get id(){return this.position.x+this.position.y*R.SIZE+1}hasValue(){return this.value>0}constructor(e,t){b()(this,"value",void 0),b()(this,"_position",void 0),b()(this,"_isStatic",void 0),b()(this,"_row",void 0),b()(this,"_column",void 0),b()(this,"_square",void 0),b()(this,"notes",void 0),this._position=e,this.value=t,this.notes=new X,this._isStatic=this.hasValue(),P()(ee,ee,te).call(ee,this)}}function te(e){e._row=R.rows[e.position.y],e._column=R.columns[e.position.x],e._square=R.squares[Math.floor(e.position.x/R.BASE_NUMBER)+Math.floor(e.position.y/R.BASE_NUMBER)*R.BASE_NUMBER]}class se{static serialize(e){const t={cells:e.cells.map((e=>({value:e.value,x:e.position.x,y:e.position.y,notes:e.notes.values,static:e.isStatic}))),seed:e.seed,solution:e.solution,difficultyLevel:e.difficultyLevel};return t}static deserialize(e,t){if(null===t)throw new Error;return e.cells.length=0,e.solution.length=0,e.cells=t.cells.map((e=>{const t=new J(e.x,e.y),s=(0,G.qj)(new ee(t,e.static?e.value:0));return e.static||(s.value=e.value),e.notes.forEach((e=>s.notes.addValue(e))),s})),e.seed=t.seed,e.solution=t.solution,e.difficultyLevel=t.difficultyLevel,e}static toIndex(e){return e.x+e.y*R.SIZE}getCell(e){const t=se.toIndex(e);return this.cells[t]}getSolutionValue(e){const t=se.toIndex(e);return this.solution[t]}findCellById(e){if(e)return this.cells.find((t=>t.id===e))}static fromBoard(e,t,s,i){e.cells.length=0,e.solution.length=0,e.seed=i;for(var l=0;l<R.SIZE;l++)for(var a=0;a<R.SIZE;a++){const i=s.getCell(l,a),n=t.getCell(l,a),o=new J(l,a),r=se.toIndex(o);e.solution[r]=i;const u=(0,G.qj)(new ee(o,n));e.cells[r]=u}return e}constructor(){b()(this,"cells",void 0),b()(this,"solution",void 0),b()(this,"difficultyLevel",void 0),this.cells=[],this.solution=[]}}const ie=e=>((0,i.dD)("data-v-08c1c2d4"),e=e(),(0,i.Cn)(),e),le=ie((()=>(0,i._)("div",{id:"circle"},null,-1))),ae={key:1},ne={key:1,id:"notes"};function oe(e,t,s,a,n,o){return(0,i.wg)(),(0,i.iD)("div",{class:(0,l.C_)(["cell",e.classObject]),onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},[e.cell.hasValue()?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[le,e.cell.isStatic?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.Uk)((0,l.zw)(e.cell.value),1)],64)):((0,i.wg)(),(0,i.iD)("span",ae,(0,l.zw)(e.cell.value),1))],64)):((0,i.wg)(),(0,i.iD)("div",ne,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.notes,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"note"},(0,l.zw)(e?t+1:""),1)))),128))]))],2)}var re=s(10098);const ue=(0,i.aZ)({name:"SudokuCell",emits:["select"],props:{puzzle:{type:se,required:!0},cell:{type:ee,required:!0},isSelected:{type:Boolean,default:!1},isSquareSelected:{type:Boolean,default:!1},isRowSelected:{type:Boolean,default:!1},isColumnSelected:{type:Boolean,default:!1},isValueSelected:{type:Boolean,default:!1},size:{type:String,default:"1.0em"}},setup(){const e=(0,re.F)();return{settings:e}},methods:{onClick(){this.isSelected||this.$emit("select")}},computed:{classObject(){return{static:this.cell.isStatic,selected:this.isSelected,"row-selected":this.isRowSelected,"column-selected":this.isColumnSelected,"square-selected":this.isSquareSelected,"value-selected":this.isValueSelected,error:this.settings.showErrors&&!0}},boardSize(){return R.SIZE},isError(){return this.cell.value>0&&this.cell.value!==this.puzzle.getSolutionValue(this.cell.position)},notes(){return Array(this.boardSize).fill(null).map(((e,t)=>this.cell.notes.hasValue(t+1)))}},watch:{}}),ce=()=>{(0,a.sj)((e=>({"56a0d328":e.size})))},de=ue.setup;ue.setup=de?(e,t)=>(ce(),de(e,t)):ce;const he=ue;var ve=s(11639);const me=(0,ve.Z)(he,[["render",oe],["__scopeId","data-v-08c1c2d4"]]),pe=me,ge=(0,i.aZ)({components:{SudokuCell:pe},name:"SodukuBoard",props:{puzzle:{type:se,required:!0},size:{type:String,default:"1.0em"}},emits:["cellSelected"],data(){return{selectedCellId:null}},methods:{onSelectCell(e){this.selectedCellId=e,this.$emit("cellSelected",e)},getSquareCells(e){return Array(R.SIZE).fill(null).map(((t,s)=>{const[i,l]=R.squares[e].get(s),a=new J(i,l),n=se.toIndex(a);return this.puzzle.cells[n]}))}},computed:{boardSize(){return R.SIZE},selectedCellIndex(){return this.puzzle.cells.findIndex((e=>e.id===this.selectedCellId))},selectedCell(){return this.selectedCellIndex>-1?this.puzzle.cells[this.selectedCellIndex]:null}}}),fe=(0,ve.Z)(ge,[["render",g],["__scopeId","data-v-9277fbe4"]]),ye=fe,we={class:"text-subtitle2"},Se={class:"text-subtitle2"};function Ce(e,t,s,a,n,o){const r=(0,i.up)("q-item-label"),u=(0,i.up)("q-item-section"),c=(0,i.up)("q-toggle"),d=(0,i.up)("q-item"),h=(0,i.up)("q-list"),v=(0,i.up)("q-card-section"),m=(0,i.up)("q-btn"),p=(0,i.up)("q-separator"),g=(0,i.up)("q-card-actions"),f=(0,i.up)("q-card"),y=(0,i.up)("q-dialog"),w=(0,i.Q2)("ripple"),S=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(y,{ref:"dialog"},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{style:{width:"80vw"}},{default:(0,i.w5)((()=>[(0,i.Wm)(v,null,{default:(0,i.w5)((()=>[(0,i.Wm)(h,{style:{"font-size":"1.2em"}},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{header:""},{default:(0,i.w5)((()=>[(0,i.Uk)("Options")])),_:1}),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.settingsToggles,(e=>(0,i.wy)(((0,i.wg)(),(0,i.j4)(d,{class:"text-body1",clickable:"",key:e.name,onClick:()=>e.prop.value=!e.prop.value},{default:(0,i.w5)((()=>[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.name),1)])),_:2},1024),(0,i.Wm)(u,{side:""},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{"keep-color":"",color:"primary",size:"lg",modelValue:e.prop.value,"onUpdate:modelValue":t=>e.prop.value=t,icon:e.icon},null,8,["modelValue","onUpdate:modelValue","icon"])])),_:2},1024)])),_:2},1032,["onClick"])),[[w]]))),128))])),_:1})])),_:1}),(0,i.Wm)(v,{class:"q-gutter-y-md"},{default:(0,i.w5)((()=>[(0,i._)("div",we,"Current level: "+(0,l.zw)(e.currentLevel),1),(0,i._)("div",Se,"Difficulty: "+(0,l.zw)(e.difficulty.name),1),(0,i.Wm)(m,{label:"Clear data",flat:"",color:"negative",class:"full-width",onClick:e.clearCache},null,8,["onClick"]),(0,i.Wm)(m,{label:"Retry level",flat:"",color:"negative",class:"full-width",onClick:e.onResetGame},null,8,["onClick"]),(0,i.Wm)(m,{label:"New level",flat:"",color:"primary",class:"full-width",onClick:e.onNewGame},null,8,["onClick"]),(0,i.Wm)(m,{label:"History",flat:"",color:"primary",class:"full-width",onClick:e.showHistory},null,8,["onClick"])])),_:1}),(0,i.Wm)(p),(0,i.Wm)(g,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(m,{flat:"",color:"primary",label:"Close"},null,512),[[S]])])),_:1})])),_:1})])),_:1},512)}const _e={style:{display:"flex","flex-direction":"row","flex-wrap":"nowrap","align-items":"center",width:"100%",height:"40px","font-size":"1.4em"}};function xe(e,t,s,a,n,o){const r=(0,i.up)("q-input"),u=(0,i.up)("q-card-section"),c=(0,i.up)("q-space"),d=(0,i.up)("difficulty-rating"),h=(0,i.up)("q-btn"),v=(0,i.up)("q-card"),m=(0,i.up)("q-dialog");return(0,i.wg)(),(0,i.j4)(m,{ref:"dialog",onHide:o.onDialogHide},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{class:"q-dialog-plugin"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{class:"text-h6"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Level "),(0,i.Wm)(r,{modelValue:a.levelNumber,"onUpdate:modelValue":t[0]||(t[0]=e=>a.levelNumber=e),mask:"##########","input-style":"text-align: center; font-size: 2em",rules:[e=>parseInt(e).toString()===e&&parseInt(e)<4294967296]},null,8,["modelValue","rules"])])),_:1}),(0,i.Wm)(u,{class:"text-h6"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Niveau ")])),_:1}),(0,i.Wm)(u,{class:"q-gutter-y-md"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.Difficulty,(e=>((0,i.wg)(),(0,i.j4)(h,{key:e.level,color:"primary",outline:"",size:"sm",align:"left",class:"full-width",onClick:()=>o.onOKClick(e)},{default:(0,i.w5)((()=>[(0,i._)("div",_e,[(0,i._)("span",null,(0,l.zw)(e.name),1),(0,i.Wm)(c),(0,i.Wm)(d,{size:"sm",level:e.level},null,8,["level"])])])),_:2},1032,["onClick"])))),128))])),_:1}),(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(h,{label:"Cancel",class:"full-width",color:"negative",onClick:o.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const ze=JSON.parse('[{"name":"Easier Than Easy","cells":9,"level":0,"logic":true},{"name":"Easy","cells":16,"level":1,"logic":true},{"name":"Novice","cells":24,"level":2,"logic":true},{"name":"Medium","cells":32,"level":3,"logic":true},{"name":"Intermediate","cells":40,"level":4,"logic":true},{"name":"Hard","cells":48,"level":5,"logic":true},{"name":"Difficult","cells":56,"level":6,"logic":false},{"name":"Expert","cells":64,"level":7,"logic":true},{"name":"☠️","cells":64,"level":8,"logic":false}]'),ke={style:{display:"flex","flex-direction":"row","align-items":"center"}};function be(e,t,s,l,a,n){const o=(0,i.up)("q-icon");return(0,i.wg)(),(0,i.iD)("div",ke,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.starCount,(t=>((0,i.wg)(),(0,i.j4)(o,{key:t,size:e.size,name:"star",color:"yellow"},null,8,["size"])))),128))])}const Ee=(0,i.aZ)({name:"DifficultyRating",props:{level:{type:Number,required:!0},size:{type:String,default:""}},computed:{starCount(){return this.level+1}}});var qe=s(22857),Ze=s(69984),Ie=s.n(Ze);const Ne=(0,ve.Z)(Ee,[["render",be]]),Me=Ne;function Be(e,t){const s=parseInt(e);return isNaN(s)?t:s}Ie()(Ee,"components",{QIcon:qe.Z});const Ve={components:{DifficultyRating:Me},name:"NewLevelDialog",props:{},emits:["ok","hide"],setup(){return{Difficulty:ze,levelNumber:(0,G.iH)(Math.floor(4294967296*Math.random()))}},methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(e){const t=Be(this.levelNumber,Math.floor(4294967296*Math.random()));this.$emit("ok",{difficultyLevel:e.level,seed:t}),this.hide()},onCancelClick(){this.hide()}}};var De=s(7657),We=s(44458),He=s(63190),Le=s(31169),Oe=s(24455),Ue=s(90136);const Qe=(0,ve.Z)(Ve,[["render",xe]]),$e=Qe;Ie()(Ve,"components",{QDialog:De.Z,QCard:We.Z,QCardSection:He.Z,QInput:Le.Z,QBtn:Oe.Z,QSpace:Ue.Z});const Ae={class:"text-center"},Re={class:"text-left"},Te={class:"row items-center text-left"},je={class:"text-left"},Ke={key:1,class:"text-body1"};function Fe(e,t,s,a,n,o){const r=(0,i.up)("q-card-section"),u=(0,i.up)("difficulty-rating"),c=(0,i.up)("q-icon"),d=(0,i.up)("q-markup-table"),h=(0,i.up)("q-btn"),v=(0,i.up)("q-card"),m=(0,i.up)("q-dialog");return(0,i.wg)(),(0,i.j4)(m,{ref:"dialog",onHide:o.onDialogHide,persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(v,{class:"q-dialog-plugin q-pa-sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{class:"text-h4"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Victories ")])),_:1}),(0,i.Wm)(r,{class:"q-my-md text-h6"},{default:(0,i.w5)((()=>[s.victories.length?((0,i.wg)(),(0,i.j4)(d,{key:0,style:{"max-height":"60vh"},separator:"horizontal",flat:"",bordered:"",class:"text-subtitle2"},{default:(0,i.w5)((()=>[(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.victories,((e,t)=>((0,i.wg)(),(0,i.iD)("tr",{key:t},[(0,i._)("td",Ae,[(0,i.Wm)(u,{level:e.difficultyLevel},null,8,["level"])]),(0,i._)("td",Re,"#"+(0,l.zw)(e.level),1),(0,i._)("td",Te,[(0,i.Wm)(c,{name:"o_lightbulb",outline:""}),(0,i.Uk)(" "+(0,l.zw)(e.hintCount),1)]),(0,i._)("td",je,(0,l.zw)(this.displayTime(e.time)),1)])))),128))])])),_:1})):((0,i.wg)(),(0,i.iD)("div",Ke,"No items in this list"))])),_:1}),(0,i.Wm)(r,{align:"right"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{label:"Close",outline:"",color:"primary",onClick:o.hide},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const Ye={components:{DifficultyRating:Me},name:"VictoryHistoryScreen",props:{victories:{type:Array,required:!0}},emits:["ok","hide"],methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},displayTime(e){const t=e%60,s=Math.floor(e/60);return s.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")}}};var Pe=s(66933);const Ge=(0,ve.Z)(Ye,[["render",Fe]]),Je=Ge;Ie()(Ye,"components",{QDialog:De.Z,QCard:We.Z,QCardSection:He.Z,QMarkupTable:Pe.Z,QIcon:qe.Z,QBtn:Oe.Z});const Xe=(0,i.aZ)({name:"SettingsScreen",props:{currentLevel:{type:Number,required:!0},difficulty:{type:Object,required:!0}},setup(){const e=(0,re.F)(),t=[{name:"Display time",icon:"o_timer",prop:(0,i.Fl)({get:()=>e.showTime,set:t=>e.showTime=t})},{name:"Highlight errors",icon:"o_fact_check",prop:(0,i.Fl)({get:()=>e.showErrors,set:t=>e.showErrors=t})},{name:"Allow hints",icon:"o_tips_and_updates",prop:(0,i.Fl)({get:()=>e.showHints,set:t=>e.showHints=t})}];return{settings:e,settingsToggles:t}},emits:["ok","hide"],methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onDialogCancel(){this.hide()},onDialogOK(e){this.$emit("ok",e),this.hide()},confirm(e){return new Promise(((t,s)=>{this.$q.dialog({title:"Warning",message:e,cancel:!0,persistent:!0,ok:{label:"Continue",color:"negative"}}).onOk((()=>t(!0))).onCancel((()=>s(!1)))}))},async onResetGame(){const e=await this.confirm("Are you sure? You cannot reverse this action.");e&&this.onDialogOK({name:"reset-level",data:{}})},async clearCache(){const e=await this.confirm("Are you sure? This will remove your current save game and the victory history. You cannot reverse this action.");e&&(this.$q.localStorage.clear(),location.reload())},onNewGame(){this.$q.dialog({component:$e}).onOk((e=>{this.onDialogOK({name:"new-level",data:{seed:e.seed,difficultyLevel:e.difficultyLevel}})}))},showHistory(){this.$q.dialog({component:Je,componentProps:{victories:(this.$q.localStorage.getItem("victories")?.data??[]).reverse()}})}}});var et=s(13246),tt=s(33115),st=s(490),it=s(76749),lt=s(23175),at=s(50926),nt=s(11821),ot=s(51136),rt=s(62146);const ut=(0,ve.Z)(Xe,[["render",Ce]]),ct=ut;Ie()(Xe,"components",{QDialog:De.Z,QCard:We.Z,QCardSection:He.Z,QList:et.Z,QItemLabel:tt.Z,QItem:st.Z,QItemSection:it.Z,QToggle:lt.Z,QBtn:Oe.Z,QSeparator:at.Z,QCardActions:nt.Z}),Ie()(Xe,"directives",{Ripple:ot.Z,ClosePopup:rt.Z});const dt={id:"number-bar"},ht={style:{display:"flex","flex-direction":"column"}};function vt(e,t,s,a,n,o){const r=(0,i.up)("q-icon"),u=(0,i.up)("q-btn");return(0,i.wg)(),(0,i.iD)("div",dt,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(Math.ceil(e.size/2),(t=>((0,i.wg)(),(0,i.iD)("div",{key:t},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columnNumbers(t),(t=>((0,i.wg)(),(0,i.j4)(u,{key:t,size:"xl",color:"white",outline:"",padding:"none",class:"number-btn",onClick:()=>e.$emit("click",t)},{default:(0,i.w5)((()=>[(0,i._)("div",ht,[(0,i.Uk)((0,l.zw)(t)+" ",1),(0,i.Wm)(r,{color:e.activeNumbers.includes(t)?"":"transparent",name:"close",class:"number-icon q-pa-none q-ma-none",padding:"none",size:"sm"},null,8,["color"])])])),_:2},1032,["onClick"])))),128))])))),128))])}const mt=(0,i.aZ)({name:"NumberBar",props:{size:{type:Number,required:!0},activeNumbers:{type:Array,default:()=>[]}},emits:["click"],setup(){},methods:{columnNumbers(e){const t=e,s=e+Math.ceil(this.size/2);return s>this.size?[t]:[t,s]}}}),pt=(0,ve.Z)(mt,[["render",vt],["__scopeId","data-v-f94a6358"]]),gt=pt;Ie()(mt,"components",{QBtn:Oe.Z,QIcon:qe.Z});const ft={class:"text-h6 row items-center"},yt={class:"q-ml-sm"},wt={class:"text-h6 row items-center"},St={class:"q-ml-sm"},Ct={class:"text-h6 row items-center"},_t={class:"q-ml-sm"},xt={class:"text-h6 row items-center"},zt={class:"q-ml-sm"};function kt(e,t,s,a,n,o){const r=(0,i.up)("q-card-section"),u=(0,i.up)("difficulty-rating"),c=(0,i.up)("q-btn"),d=(0,i.up)("q-card"),h=(0,i.up)("q-dialog");return(0,i.wg)(),(0,i.j4)(h,{ref:"dialog",onHide:o.onDialogHide,persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{class:"q-dialog-plugin q-pa-sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{class:"text-h2"},{default:(0,i.w5)((()=>[(0,i.Uk)(" You Won! ")])),_:1}),(0,i.Wm)(r,{class:"q-gutter-y-md text-h6"},{default:(0,i.w5)((()=>[(0,i._)("div",ft,[(0,i.Uk)(" Difficulty: "),(0,i._)("span",yt,[(0,i.Wm)(u,{level:s.puzzle.difficultyLevel},null,8,["level"])])]),(0,i._)("div",wt,[(0,i.Uk)(" Hints: "),(0,i._)("span",St,(0,l.zw)(s.hintCount),1)]),(0,i._)("div",Ct,[(0,i.Uk)(" Time Taken: "),(0,i._)("span",_t,(0,l.zw)(o.displayTime),1)]),(0,i._)("div",xt,[(0,i.Uk)(" Level: "),(0,i._)("span",zt,"#"+(0,l.zw)(s.puzzle.seed),1)])])),_:1}),(0,i.Wm)(r,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,{label:"Play Another",class:"full-width",size:"lg",color:"primary",onClick:o.nextLevel},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const bt={name:"VictoryScreen",components:{DifficultyRating:Me},props:{puzzle:{type:se,required:!0},time:{type:Number,required:!0},hintCount:{type:Number,required:!0}},emits:["ok","hide"],methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},nextLevel(){this.$q.dialog({component:$e}).onOk((e=>{this.$emit("ok",e),this.hide()}))}},computed:{displayTime(){const e=this.time%60,t=Math.floor(this.time/60);return t.toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")}}},Et=(0,ve.Z)(bt,[["render",kt]]),qt=Et;Ie()(bt,"components",{QDialog:De.Z,QCard:We.Z,QCardSection:He.Z,QBtn:Oe.Z});class Zt{on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter((e=>e!==t)))}dispatch(e,t){this.events[e]&&this.events[e].forEach((e=>e(t)))}constructor(){b()(this,"events",void 0),this.events={}}}new Zt;class It{static serialize(e){return e.data.map((e=>JSON.stringify(e)))}static deserialize(e,t){return e.clear(),t.forEach((t=>{const s=JSON.parse(t);e.data.push(s)})),e}clear(){this.data.length=0}rollBack(){return 0===this.data.length?null:this.data.pop()}store(e){if(Array.isArray(e)||(e=[e]),0===e.length)return;const t=e.map(P()(It,It,Nt));this.data.push(t)}get size(){return this.data.length}constructor(){b()(this,"data",void 0),this.data=[]}}function Nt(e){return JSON.parse(JSON.stringify(e))}var Mt=s(83457),Bt=s(34962);function Vt(e,t){const s=parseInt(e);return isNaN(s)?t:s}class Dt{dispatchUpdate(){this.eventBus.dispatch("update",{time:this.time})}updateTimer(){this.paused||(this.time++,this.dispatchUpdate())}set(e){this.time=Vt(e,0),this.dispatchUpdate()}start(){(0,i.YP)((()=>Bt.Z.appVisible),(e=>{e?this.__timer=window.setInterval(this.updateTimer.bind(this),1e3):window.clearInterval(this.__timer)}),{immediate:!0})}constructor(e){b()(this,"time",void 0),b()(this,"paused",void 0),b()(this,"eventBus",void 0),b()(this,"__timer",0),this.eventBus=new Zt,this.paused=!1,this.time=Vt(e,0)}}var Wt=s(37628),Ht=s.n(Wt),Lt=s(40559),Ot=s.n(Lt);s(58672);class Ut{static getOptionCount(e){for(var t=0,s=0;s<R.SIZE;s++)e.get(s)&&t++;return t}static getOptionValues(e){const t=[];for(var s=0;s<R.SIZE;s++)e.get(s)&&t.push(s+1);return t}getCellWithLeastOptions(){for(var e=R.SIZE+1,t=null,s=0;s<R.SIZE;s++)for(var i=0;i<R.SIZE;i++){if(this.board.getCell(i,s))continue;const l=this.getNotesForCell(i,s),a=Ut.getOptionCount(l);if(2===a)return[i,s];a<e&&(t=[i,s],e=a)}return t}getNotesForCell(e,t){return this.cellnotes[e+t*R.SIZE]}setup(){for(var e=0;e<R.SIZE;e++)for(var t=0;t<R.SIZE;t++)this.cellnotes.push(P()(Ut,Ut,Qt).call(Ut,this.board,t,e))}clone(e){const t=new Ut(e);return t.cellnotes=this.cellnotes.map((e=>e.clone())),t}static fromBoard(e){const t=new Ut(e);return t.setup(),t}constructor(e){b()(this,"cellnotes",void 0),this.id=Z.getId(),this.cellnotes=[],this.board=e}}function Qt(e,t,s){const i=new H;if(e.getCell(t,s))return i;for(var l=0;l<R.SIZE;l++){const a=[R.getRow(t,s),R.getColumn(t,s),R.getSquare(t,s)],n=l+1,o=a.reduce(((t,s)=>t&&!L.includesValue(e,s,n)),!0);i.set(l,o)}return i}function $t(e){return new Promise((t=>setTimeout((()=>t(e())),0)))}var At=new WeakMap;class Rt{constructor(){S()(this,At,{writable:!0,value:0})}async getResult(e){var t;return _()(this,At,(t=z()(this,At),t++,t)),z()(this,At)>50?(_()(this,At,0),$t(e)):new Promise((t=>t(e())))}}function Tt(e){return e.find((e=>void 0!==e))}const jt=17;async function Kt(e,t,s){s=!0===s;const i=new V(t),l=F.randomSkeleton(i),a=new Jt,n=Tt(await a.getSolutions(l,1,i));if(!n)throw new Error("Error creating new solution");const o=Array(R.SIZE).fill(null).map(((e,t)=>[...Array(R.SIZE).keys()].map((e=>[e,t])))).reduce(((e,t)=>e.concat(t)),[]);W(o,i);var r=0;const u=n.duplicate();for(var c=0;c<o.length&&r+jt<R.CELL_COUNT;c++){const[t,l]=o[c],n=u.getCell(t,l);u.setCell(t,l,0);const d=await a.getSolutions(u,2,i,s);if(1!==d.length)u.setCell(t,l,n);else if(r++,r>=e)break}return[n,u,i.seed]}class Ft extends Error{constructor(e){super(e),this.name="SolutionError"}}var Yt=new WeakSet,Pt=new WeakSet,Gt=new WeakSet;class Jt{constructor(e){Ht()(this,Gt),Ht()(this,Pt),Ht()(this,Yt),b()(this,"board",void 0),this.id=Z.getId(),this.board=e}boardCompare(e,t){const s=R.CELL_COUNT;for(var i=0;i<s;i++){e.cells.get(i),t.cells.get(i)}return!0}notebookCompare(e,t){const s=R.CELL_COUNT;for(var i=0;i<s;i++){const s=Ut.getOptionValues(e.cellnotes[i]),l=Ut.getOptionValues(t.cellnotes[i]),a=s.reduce(((e,t,s)=>{const i=l[s];return e&&t===i}),!0);if(!a)return!1}return!0}async getSolutions(e,t,s,i,l,a,n,o){a=!1!==a,t=t||1,s=s??new V,i=!0===i,n=n??0,o=o||new Rt;const r=a?e.clone():e,u=a&&l?l.clone(r):Ut.fromBoard(r);try{while(Ot()(this,Gt,ts).call(this,u,s));}catch(g){if(g instanceof Ft)return console.debug(g.message),[];throw g}if(i||r.isFinished())return r.isValid()?[r]:[];const[c,d]=u.getCellWithLeastOptions(),h=u.getNotesForCell(c,d),v=Ut.getOptionValues(h);for(var m=[],p=0;p<v.length;p++){const e=v[p],l=r.clone(),a=u.clone(l);Ot()(this,Pt,es).call(this,a,c,d,e);const h=await o.getResult((()=>this.getSolutions(l,t,s,i,a,!1,n+m.length,o)));if(m=m.concat(h),m.length+n>=t)return m}return m}}function Xt(e,t,s){if(e.board.getCell(t,s))return!1;const i=e.getNotesForCell(t,s),l=Ut.getOptionValues(i);if(l.length>1)return!1;if(0===l.length)throw new Ft(`Cell ${t}, ${s} cannot be filled`);return Ot()(this,Pt,es).call(this,e,t,s,l[0]),!0}function es(e,t,s,i){e.board.setCell(t,s,i);const l=[R.getRow(t,s),R.getColumn(t,s),R.getSquare(t,s)];l.forEach((t=>{for(var s=0;s<R.SIZE;s++){const[l,a]=t.get(s),n=e.getNotesForCell(l,a);n.set(i-1,!1),Ot()(this,Yt,Xt).call(this,e,l,a)}}))}function ts(e,t){var s=!1;const i=Array(R.SIZE).fill(null).map(((t,s)=>[...Array(R.SIZE).keys()].filter((t=>!e.board.getCell(t,s))).map((e=>[e,s])))).reduce(((e,t)=>e.concat(t)),[]);return W(i,t),i.forEach((([t,i])=>{Ot()(this,Yt,Xt).call(this,e,t,i)&&(s=!0)})),s}const ss=JSON.parse('{"cells":[{"value":9,"x":0,"y":0,"notes":[],"static":true},{"value":1,"x":1,"y":0,"notes":[],"static":true},{"value":5,"x":2,"y":0,"notes":[],"static":true},{"value":7,"x":3,"y":0,"notes":[],"static":true},{"value":2,"x":4,"y":0,"notes":[],"static":true},{"value":4,"x":5,"y":0,"notes":[],"static":true},{"value":6,"x":6,"y":0,"notes":[],"static":true},{"value":3,"x":7,"y":0,"notes":[],"static":true},{"value":8,"x":8,"y":0,"notes":[],"static":true},{"value":3,"x":0,"y":1,"notes":[],"static":true},{"value":4,"x":1,"y":1,"notes":[],"static":true},{"value":7,"x":2,"y":1,"notes":[],"static":true},{"value":8,"x":3,"y":1,"notes":[],"static":true},{"value":6,"x":4,"y":1,"notes":[],"static":true},{"value":5,"x":5,"y":1,"notes":[],"static":true},{"value":9,"x":6,"y":1,"notes":[],"static":true},{"value":2,"x":7,"y":1,"notes":[],"static":true},{"value":1,"x":8,"y":1,"notes":[],"static":true},{"value":2,"x":0,"y":2,"notes":[],"static":true},{"value":0,"x":1,"y":2,"notes":[],"static":false},{"value":0,"x":2,"y":2,"notes":[],"static":false},{"value":3,"x":3,"y":2,"notes":[],"static":true},{"value":9,"x":4,"y":2,"notes":[],"static":true},{"value":1,"x":5,"y":2,"notes":[],"static":true},{"value":0,"x":6,"y":2,"notes":[],"static":false},{"value":4,"x":7,"y":2,"notes":[],"static":true},{"value":7,"x":8,"y":2,"notes":[],"static":true},{"value":5,"x":0,"y":3,"notes":[],"static":true},{"value":8,"x":1,"y":3,"notes":[],"static":true},{"value":4,"x":2,"y":3,"notes":[],"static":true},{"value":2,"x":3,"y":3,"notes":[],"static":true},{"value":7,"x":4,"y":3,"notes":[],"static":true},{"value":3,"x":5,"y":3,"notes":[],"static":true},{"value":1,"x":6,"y":3,"notes":[],"static":true},{"value":0,"x":7,"y":3,"notes":[],"static":false},{"value":9,"x":8,"y":3,"notes":[],"static":true},{"value":6,"x":0,"y":4,"notes":[],"static":true},{"value":2,"x":1,"y":4,"notes":[],"static":true},{"value":1,"x":2,"y":4,"notes":[],"static":true},{"value":5,"x":3,"y":4,"notes":[],"static":true},{"value":4,"x":4,"y":4,"notes":[],"static":true},{"value":9,"x":5,"y":4,"notes":[],"static":true},{"value":7,"x":6,"y":4,"notes":[],"static":true},{"value":8,"x":7,"y":4,"notes":[],"static":true},{"value":3,"x":8,"y":4,"notes":[],"static":true},{"value":0,"x":0,"y":5,"notes":[],"static":false},{"value":0,"x":1,"y":5,"notes":[],"static":false},{"value":9,"x":2,"y":5,"notes":[],"static":true},{"value":1,"x":3,"y":5,"notes":[],"static":true},{"value":0,"x":4,"y":5,"notes":[],"static":false},{"value":6,"x":5,"y":5,"notes":[],"static":true},{"value":2,"x":6,"y":5,"notes":[],"static":true},{"value":5,"x":7,"y":5,"notes":[],"static":true},{"value":4,"x":8,"y":5,"notes":[],"static":true},{"value":1,"x":0,"y":6,"notes":[],"static":true},{"value":7,"x":1,"y":6,"notes":[],"static":true},{"value":3,"x":2,"y":6,"notes":[],"static":true},{"value":4,"x":3,"y":6,"notes":[],"static":true},{"value":5,"x":4,"y":6,"notes":[],"static":true},{"value":2,"x":5,"y":6,"notes":[],"static":true},{"value":8,"x":6,"y":6,"notes":[],"static":true},{"value":9,"x":7,"y":6,"notes":[],"static":true},{"value":0,"x":8,"y":6,"notes":[],"static":false},{"value":0,"x":0,"y":7,"notes":[],"static":false},{"value":9,"x":1,"y":7,"notes":[],"static":true},{"value":2,"x":2,"y":7,"notes":[],"static":true},{"value":6,"x":3,"y":7,"notes":[],"static":true},{"value":3,"x":4,"y":7,"notes":[],"static":true},{"value":7,"x":5,"y":7,"notes":[],"static":true},{"value":4,"x":6,"y":7,"notes":[],"static":true},{"value":1,"x":7,"y":7,"notes":[],"static":true},{"value":5,"x":8,"y":7,"notes":[],"static":true},{"value":4,"x":0,"y":8,"notes":[],"static":true},{"value":5,"x":1,"y":8,"notes":[],"static":true},{"value":6,"x":2,"y":8,"notes":[],"static":true},{"value":9,"x":3,"y":8,"notes":[],"static":true},{"value":1,"x":4,"y":8,"notes":[],"static":true},{"value":8,"x":5,"y":8,"notes":[],"static":true},{"value":3,"x":6,"y":8,"notes":[],"static":true},{"value":7,"x":7,"y":8,"notes":[],"static":true},{"value":2,"x":8,"y":8,"notes":[],"static":true}],"seed":1,"solution":[9,1,5,7,2,4,6,3,8,3,4,7,8,6,5,9,2,1,2,6,8,3,9,1,5,4,7,5,8,4,2,7,3,1,6,9,6,2,1,5,4,9,7,8,3,7,3,9,1,8,6,2,5,4,1,7,3,4,5,2,8,9,6,8,9,2,6,3,7,4,1,5,4,5,6,9,1,8,3,7,2],"difficultyLevel":0}');class is{static __initSaveManager(e){e.saveManager=new Mt.Z("game"),e.saveManager.states.push(new Mt.b("puzzle",(()=>se.serialize(e.puzzle)),(t=>se.deserialize(e.puzzle,t)),(()=>{se.deserialize(e.puzzle,ss)})),new Mt.b("time",(()=>e.timer.time),(t=>e.timer.set(t)),(()=>e.timer.set(0))),new Mt.b("hintCount",(()=>e.hintCount),(t=>e.hintCount=t),(()=>e.hintCount=0)),new Mt.b("memory",(()=>It.serialize(e.memory)),(t=>{It.deserialize(e.memory,t)}),(()=>e.memory.clear())))}__createMemoryState(e,t,{isNote:s,isHint:i}={}){return{cellId:e,value:t,isNote:!0===s,isHint:!0===i}}__saveMemoryState(e,t,{isNote:s,isHint:i}={}){const l=this.__createMemoryState(e,t,{isNote:s,isHint:i});this.memory.store(l)}__updateVictoryState(){const e=this.puzzle.cells.reduce(((e,t,s)=>e&&this.puzzle.solution[s]===t.value),!0);return!!e&&(this.eventBus.dispatch("victory",{}),!0)}__ensureCanEditCell(e){return e?!e.isStatic||(this.__dispatchError("Cannot edit this cell."),!1):(this.__dispatchError("No cell selected."),!1)}__dispatchError(e){this.eventBus.dispatch("error",{message:e})}placeNum(e,t,{isHint:s=!1}={}){const i=this.puzzle.findCellById(e);if(this.__ensureCanEditCell(i)){if(this.__saveMemoryState(e,i.value,{isNote:!1,isHint:s}),i.value===t)i.value=0;else if(i.value=t,this.__updateVictoryState())return;this.saveManager.save()}}placeNote(e,t){const s=this.puzzle.findCellById(e);this.__ensureCanEditCell(s)&&(s.hasValue()?this.__dispatchError("Cell already has a value."):(this.__saveMemoryState(e,s.notes.values,{isNote:!0,isHint:!1}),s.notes.swapValue(t),this.saveManager.save()))}clearCell(e){const t=this.puzzle.findCellById(e);this.__ensureCanEditCell(t)&&(t.hasValue()||t.notes.values.length)&&(t.hasValue()?(this.__saveMemoryState(e,t.value,{isNote:!1,isHint:!1}),t.value=0):(this.__saveMemoryState(e,t.notes.values,{isNote:!0,isHint:!1}),t.notes.clear()),this.saveManager.save())}undo(){if(!this.memory.size)return;const e=this.memory.rollBack();e.forEach((e=>{const t=this.puzzle.findCellById(e.cellId),s=e.value;switch(e.isNote){case!1:t.value=s;break;case!0:t.notes.set(s);break}e.isHint&&this.hintCount--})),this.saveManager.save()}hint(){const e=this.puzzle.cells.find((e=>!e.hasValue()));if(!e)return;const t=this.puzzle.solution[se.toIndex(e.position)];this.__saveMemoryState(e.id,0,{isNote:!1,isHint:!0}),e.value=t,this.hintCount++,this.__updateVictoryState()||this.saveManager.save()}resetGameState(){this.timer.set(0),this.memory.clear(),this.hintCount=0,this.saveManager.save()}resetLevel(){this.puzzle.cells.forEach((e=>{e.isStatic||(e.value=0,e.notes.clear())})),this.resetGameState(),this.saveManager.save()}async newLevel(e,t){const s=ze.find((t=>t.level===e))??ze[0],[i,l,a]=await Kt(s.cells,t);se.fromBoard(this.puzzle,l,i,a),this.puzzle.difficultyLevel=e,this.resetGameState(),this.saveManager.save()}constructor(){b()(this,"puzzle",void 0),b()(this,"saveManager",void 0),b()(this,"memory",void 0),b()(this,"timer",void 0),b()(this,"hintCount",void 0),b()(this,"eventBus",void 0),this.eventBus=new Zt,this.memory=new It,this.timer=new Dt,this.puzzle=new se,this.hintCount=0,is.__initSaveManager(this)}}const ls=(0,i.aZ)({components:{SudokuBoard:ye,NumberBar:gt,DifficultyRating:Me},name:"IndexPage",setup(){const e=(0,re.F)(),t=(0,G.qj)(new is);return{settings:e,gameState:t,renderKey:(0,G.iH)(0)}},created(){this.gameState.saveManager.load(),this.gameState.eventBus.on("victory",(e=>{this.showVictory()})),this.gameState.eventBus.on("error",(e=>{this.showError(e.message)})),this.gameState.timer.start()},data(){return{noteMode:!1,selectedCellId:null}},methods:{showError(e){this.$q.notify({message:e,group:!1,type:"negative",timeout:1e3,actions:[{icon:"close",color:"white"}]})},showVictory(){const e=this.gameState.timer.time,t=this.$q.localStorage.getItem("victories")?.data??[];t.push({level:this.gameState.puzzle.seed,time:e,hintCount:this.gameState.hintCount,difficultyLevel:this.gameState.puzzle.difficultyLevel}),this.$q.localStorage.set("victories",{data:t}),this.$q.dialog({component:qt,componentProps:{puzzle:this.gameState.puzzle,time:e,hintCount:this.gameState.hintCount}}).onOk((async e=>{await this.generateLevel(e.difficultyLevel,e.seed)}))},async generateLevel(e,t){this.$q.loading.show({message:"Generating level...",delay:1}),await this.gameState.newLevel(e,t),this.$q.loading.hide()},showSettings(){this.$q.dialog({component:ct,componentProps:{currentLevel:this.gameState.puzzle.seed,difficulty:this.gameDifficulty}}).onOk((async e=>{switch(e.name){case"new-level":await this.generateLevel(e.data.difficultyLevel,e.data.seed);break;case"reset-level":this.gameState.resetLevel();break}}))},placeNumber(e){this.noteMode?this.gameState.placeNote(this.selectedCellId,e):this.gameState.placeNum(this.selectedCellId,e)},clearCell(){this.gameState.clearCell(this.selectedCellId)},hint(){this.gameState.hint()},cellSelected(e){this.selectedCellId=e},undo(){this.gameState.undo()}},computed:{boardSize(){return R.SIZE},selectedCell(){return this.gameState.puzzle.findCellById(this.selectedCellId)},activeNumbers(){return this.selectedCell?this.selectedCell.isStatic||this.selectedCell.value?[]:this.selectedCell.notes.values:[]},puzzleTime(){const e=this.gameState.timer.time,t=0+e%60,s=0+Math.floor(e/60);return s.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")},gameDifficulty(){return ze.find((e=>e.level===this.gameState.puzzle?.difficultyLevel))||ze[0]}}});var as=s(69885);const ns=(0,ve.Z)(ls,[["render",v],["__scopeId","data-v-61e36f68"]]),os=ns;Ie()(ls,"components",{QPage:as.Z,QSpace:Ue.Z,QBtn:Oe.Z,QToggle:lt.Z})}}]);