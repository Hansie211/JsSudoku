"use strict";(globalThis["webpackChunkjs_sudoku"]=globalThis["webpackChunkjs_sudoku"]||[]).push([[978],{83457:(e,t,s)=>{s.d(t,{Z:()=>o,b:()=>n});var i=s(38761),l=s.n(i),a=s(63703);class n{constructor(e,t,s,i){l()(this,"getState",void 0),l()(this,"setState",void 0),l()(this,"setDefault",void 0),l()(this,"key",void 0),this.key=e,this.getState=t,this.setState=s,this.setDefault=i}}class o{save(){const e={};this.states.forEach((t=>{const s=t.key,i=t.getState();e[s]=JSON.stringify(i)})),a.Z.set(this.storageKey,e)}load(){const e=a.Z.getItem(this.storageKey)??{};this.states.forEach((t=>{const s=t.key;try{const i=JSON.parse(e[s]);t.setState(i)}catch(i){t.setDefault()}}))}constructor(e){l()(this,"states",void 0),l()(this,"storageKey",void 0),this.storageKey=e,this.states=[]}}},10098:(e,t,s)=>{s.d(t,{F:()=>r});s(69665);var i=s(81809),l=s(60499),a=s(59835);const n=JSON.parse('{"cb":0,"G1":4,"OD":3}');var o=s(83457);const r=(0,i.Q_)("settings",(()=>{const e={showErrors:(0,l.iH)(void 0),showTime:(0,l.iH)(void 0),showHints:(0,l.iH)(void 0),markImpossibleNumbers:(0,l.iH)(void 0),placeNumbersOnSelect:(0,l.iH)(void 0)},t=new o.Z;Object.keys(e).forEach((s=>{t.states.push(new o.b(s,(()=>e[s].value),(t=>e[s].value=t),(()=>e[s].value=!0)))})),t.load(),Object.keys(e).forEach((s=>(0,a.YP)(e[s],(()=>t.save()))));const s=`v${n.cb}.${n.G1}.${n.OD}`;return{...e,version:s}}))},5978:(e,t,s)=>{s.r(t),s.d(t,{default:()=>rs});var i=s(59835),l=s(86970),a=s(61957);const n={id:"bottom-bar",class:"flex column full-width"},o={id:"info-bar",class:"flex row full-width q-px-sm"},r={class:"text-caption q-mr-sm flex flex-center"},u={class:"text-caption flex-center"},c={id:"action-bar",class:"full-width"},d={id:"mode-bar",class:"row q-pa-sm"};function h(e,t,s,h,m,v){const p=(0,i.up)("sudoku-board"),g=(0,i.up)("q-space"),f=(0,i.up)("difficulty-rating"),y=(0,i.up)("q-btn"),w=(0,i.up)("q-toggle"),S=(0,i.up)("number-bar"),C=(0,i.up)("q-page");return e.gameState.puzzle?((0,i.wg)(),(0,i.j4)(C,{key:0,id:"page"},{default:(0,i.w5)((()=>[(0,i._)("div",null,[((0,i.wg)(),(0,i.j4)(p,{ref:"sudoku",puzzle:e.gameState.puzzle,key:e.renderKey,size:"4.7vw",onCellSelected:e.cellSelected,onCellUpdated:e.cellUpdated},null,8,["puzzle","onCellSelected","onCellUpdated"]))]),(0,i._)("div",n,[(0,i._)("div",o,[(0,i.wy)((0,i._)("div",null,(0,l.zw)(e.puzzleTime),513),[[a.F8,e.settings.showTime]]),(0,i.Wm)(g),(0,i._)("div",r,[(0,i.Wm)(f,{level:e.gameDifficulty.level},null,8,["level"])]),(0,i._)("div",u,"Hints "+(0,l.zw)(e.gameState.hintCount),1)]),(0,i._)("div",c,[(0,i._)("div",d,[(0,i.Wm)(y,{icon:"settings",round:"",flat:"",size:"md",onClick:e.showSettings},null,8,["onClick"]),(0,i.Wm)(g),(0,i.Wm)(y,{icon:"undo",flat:"",round:"",size:"md",onClick:e.undo},null,8,["onClick"]),(0,i.wy)((0,i.Wm)(y,{icon:"tips_and_updates",flat:"",round:"",size:"md",onClick:e.hint},null,8,["onClick"]),[[a.F8,e.settings.showHints]]),(0,i.Wm)(w,{modelValue:e.noteMode,"onUpdate:modelValue":t[0]||(t[0]=t=>e.noteMode=t),icon:"edit",color:"positive"},null,8,["modelValue"]),(0,i.Wm)(y,{icon:"backspace",flat:"",round:"",size:"md",onClick:e.clearCell},null,8,["onClick"])]),(0,i.Wm)(S,{size:9,onClick:e.onTapNumber,activeNumbers:e.activeNumbers,inactiveNumbers:e.inactiveNumbers,completedNumbers:e.completedNumbers},null,8,["onClick","activeNumbers","inactiveNumbers","completedNumbers"])])])])),_:1})):(0,i.kq)("",!0)}s(69665);const m={class:"text-h6"},v={id:"board"};function p(e,t,s,a,n,o){const r=(0,i.up)("sudoku-cell");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i._)("div",m,"Sudoku #"+(0,l.zw)(e.puzzle.seed),1),(0,i._)("div",v,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.boardSize,((t,s)=>((0,i.wg)(),(0,i.iD)("div",{key:s,class:"square"},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.getSquareCells(s),(t=>((0,i.wg)(),(0,i.j4)(r,{key:t.id,puzzle:e.puzzle,cell:t,isRowSelected:e.selectedCell?.row.index===t.row.index,isColumnSelected:e.selectedCell?.column.index===t.column.index,isSquareSelected:e.selectedCell?.square.index===t.square.index,isSelected:e.selectedCellId===t.id,isValueSelected:e.selectedCell?.hasValue()&&e.selectedCell?.value===t.value,onSelect:()=>e.onSelectCell(t.id),onUpdate:(s,i)=>e.$emit("cellUpdated",t.id,s,i),size:e.size},null,8,["puzzle","cell","isRowSelected","isColumnSelected","isSquareSelected","isSelected","isValueSelected","onSelect","onUpdate","size"])))),128))])))),128))])])}var g=s(727),f=s.n(g),y=s(75105),w=s.n(y),S=s(10357),C=s.n(S),x=s(42768),_=s.n(x),b=s(38761),z=s.n(b),k=s(33782),E=s.n(k);class q{static getId(){var e;return E()(q,q,N,(e=f()(q,q,N),++e))}}var N={writable:!0,value:0};function I(e){return function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/4294967296}}var Z=new WeakMap,M=new WeakMap;class B{get seed(){return _()(this,Z)}next(){return _()(this,M).call(this)}constructor(e,t){w()(this,Z,{writable:!0,value:void 0}),w()(this,M,{writable:!0,value:void 0}),void 0===e&&(e=Math.floor(4294967296*Math.random())),C()(this,Z,e);const s=3735928559*e%4294967296,i=t||I;C()(this,M,i(s))}}function W(e,t,s){const i=e[t];e[t]=e[s],e[s]=i}function D(e,t){for(var s=0;s<e.length;s++){const i=Math.floor(t.next()*e.length);W(e,s,i)}}s(6822);class V{get(e){return void 0!==this.data[e]?this.data[e]:this.parent?this.parent.get(e):void 0}set(e,t){if(void 0===t)throw new Error("UNDEF?");this.data[e]=t}clone(){const e=new V(this.size);return e.parent=this,e}constructor(e){z()(this,"parent",void 0),z()(this,"data",void 0),z()(this,"size",void 0),this.id=q.getId(),this.parent=null,this.data=[],this.size=e}}class H{static getValue(e,t,s){const[i,l]=t.get(s);return e.getCell(i,l)}static setValue(e,t,s,i){const[l,a]=t.get(s);e.setCell(l,a,i)}static isValid(e,t){const s=[];for(var i=0;i<Q.SIZE;i++){const l=H.getValue(e,t,i);if(!l)return!1;const a=l-1;if(void 0!==s[a])return!1;s[a]=!0}return!0}static includesValue(e,t,s){for(var i=0;i<Q.SIZE;i++){const l=H.getValue(e,t,i);if(l===s)return!0}return!1}get(e){}constructor(e){z()(this,"index",void 0),this.id=q.getId(),this.index=e}}class L extends H{get(e){const t=this.index,s=e;return[t,s]}constructor(e){super(e),z()(this,"type","col"),this.get=this.get.bind(this)}}class O extends H{get(e){const t=e,s=this.index;return[t,s]}constructor(e){super(e),z()(this,"type","row"),this.get=this.get.bind(this)}}var U=new WeakMap,A=new WeakMap;class $ extends H{get(e){const t=e%Q.BASE_NUMBER,s=Math.floor(e/Q.BASE_NUMBER),i=_()(this,U)+t,l=_()(this,A)+s;return[i,l]}constructor(e){super(e),z()(this,"type","square"),w()(this,U,{writable:!0,value:void 0}),w()(this,A,{writable:!0,value:void 0}),C()(this,U,this.index%Q.BASE_NUMBER*Q.BASE_NUMBER),C()(this,A,Math.floor(this.index/Q.BASE_NUMBER)*Q.BASE_NUMBER),this.get=this.get.bind(this)}}class Q{static get CELL_COUNT(){return Q.SIZE*Q.SIZE}static get SIZE(){return Q.BASE_NUMBER*Q.BASE_NUMBER}static get BASE_NUMBER(){return 3}static get rows(){return f()(this,Q,R)}static get columns(){return f()(this,Q,T)}static get squares(){return f()(this,Q,j)}static getRow(e,t){return Q.rows[t]}static getColumn(e,t){return Q.columns[e]}static getSquare(e,t){const s=Math.floor(e/Q.BASE_NUMBER),i=Math.floor(t/Q.BASE_NUMBER),l=s+i*Q.BASE_NUMBER;return Q.squares[l]}}var R={writable:!0,value:Array(Q.SIZE).fill(null).map(((e,t)=>new O(t)))},T={writable:!0,value:Array(Q.SIZE).fill(null).map(((e,t)=>new L(t)))},j={writable:!0,value:Array(Q.SIZE).fill(null).map(((e,t)=>new $(t)))};class K{static randomSkeleton(e){const t=new K,s=[0,4,8];for(var i=0;i<s.length;i++){const a=Q.squares[s[i]],n=[...Array(Q.SIZE).keys()];D(n,e);for(var l=0;l<Q.SIZE;l++)H.setValue(t,a,l,n[l])}return t}getCell(e,t){return this.cells.get(e*Q.SIZE+t)??0}setCell(e,t,s){return this.cells.set(e*Q.SIZE+t,s)}clone(){const e=new K;return e.cells=this.cells.clone(),e}duplicate(){const e=new K;for(var t=0;t<Q.CELL_COUNT;t++){const s=this.cells.get(t);e.cells.set(t,s)}return e}import(e){this.cells=e.cells}isFinished(){for(var e=0;e<Q.CELL_COUNT;e++)if(!this.cells.get(e))return!1;return!0}isValid(){for(var e=0;e<Q.SIZE;e++){const t=[Q.rows[e],Q.columns[e],Q.squares[e]],s=t.reduce(((e,t)=>e&&H.isValid(this,t)),!0);if(!s)return!1}return!0}print(){for(var e=0;e<Q.SIZE;e++){Q.rows[e];for(var t=e+": ",s=0;s<Q.SIZE;s++){const i=this.getCell(s,e).toString();t+=i}console.log(t)}console.log("\n\n")}constructor(){z()(this,"cells",void 0),this.id=q.getId(),this.cells=new V(Q.CELL_COUNT)}}var F=s(79559),Y=s.n(F);s(46727);class P{get x(){return this._x}get y(){return this._y}constructor(e,t){z()(this,"_x",void 0),z()(this,"_y",void 0),this._x=e,this._y=t}}class G{hasValue(e){return this.values.includes(e)}addValue(e){this.hasValue(e)||this.values.push(e)}removeValue(e){const t=this.values.indexOf(e);t<0||this.values.splice(t,1)}swapValue(e){this.hasValue(e)?this.removeValue(e):this.addValue(e)}clear(){this.values.length=0}set(e){this.values.length=0,e.forEach((e=>this.values.push(e)))}constructor(){z()(this,"values",void 0),this.values=[]}}class J{get position(){return this._position}get isStatic(){return this._isStatic}get row(){return this._row}get column(){return this._column}get square(){return this._square}get id(){return this.position.x+this.position.y*Q.SIZE+1}hasValue(){return this.value>0}constructor(e,t){z()(this,"value",void 0),z()(this,"_position",void 0),z()(this,"_isStatic",void 0),z()(this,"_row",void 0),z()(this,"_column",void 0),z()(this,"_square",void 0),z()(this,"notes",void 0),this._position=e,this.value=t,this.notes=new G,this._isStatic=this.hasValue(),Y()(J,J,X).call(J,this)}}function X(e){e._row=Q.rows[e.position.y],e._column=Q.columns[e.position.x],e._square=Q.squares[Math.floor(e.position.x/Q.BASE_NUMBER)+Math.floor(e.position.y/Q.BASE_NUMBER)*Q.BASE_NUMBER]}class ee{static serialize(e){const t={cells:e.cells.map((e=>({value:e.value,x:e.position.x,y:e.position.y,notes:e.notes.values,static:e.isStatic}))),seed:e.seed,solution:e.solution,difficultyLevel:e.difficultyLevel};return t}static deserialize(e,t){if(null===t)throw new Error;return e.cells.length=0,e.solution.length=0,e.cells=t.cells.map((e=>{const t=new P(e.x,e.y),s=new J(t,e.static?e.value:0);return e.static||(s.value=e.value),e.notes.forEach((e=>s.notes.addValue(e))),s})),e.seed=t.seed,e.solution=t.solution,e.difficultyLevel=t.difficultyLevel,e}static toIndex({position:e,xy:t,x:s=0,y:i=0}={}){const l=void 0!==e?e.x:void 0!==t?t[0]:s,a=void 0!==e?e.y:void 0!==t?t[1]:i;return l+a*Q.SIZE}getCell({position:e,xy:t,x:s=0,y:i=0}={}){const l=ee.toIndex({position:e,xy:t,x:s,y:i});return this.cells[l]}getSolutionValue({position:e,xy:t,x:s=0,y:i=0}={}){const l=ee.toIndex({position:e,xy:t,x:s,y:i});return this.solution[l]}findCellById(e){if(e)return this.cells.find((t=>t.id===e))}static fromBoard(e,t,s,i){e.cells.length=0,e.solution.length=0,e.seed=i;for(var l=0;l<Q.SIZE;l++)for(var a=0;a<Q.SIZE;a++){const i=s.getCell(l,a),n=t.getCell(l,a),o=new P(l,a),r=ee.toIndex({position:o});e.solution[r]=i;const u=new J(o,n);e.cells[r]=u}return e}constructor(){z()(this,"cells",void 0),z()(this,"solution",void 0),z()(this,"difficultyLevel",void 0),this.cells=[],this.solution=[]}}const te=e=>((0,i.dD)("data-v-910ae26c"),e=e(),(0,i.Cn)(),e),se=te((()=>(0,i._)("div",{id:"circle"},null,-1))),ie={key:1},le={key:1,id:"notes"};function ae(e,t,s,a,n,o){return(0,i.wg)(),(0,i.iD)("div",{class:(0,l.C_)(["cell",e.classObject]),onClick:t[0]||(t[0]=(...t)=>e.onClick&&e.onClick(...t))},[e.cell.hasValue()?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[se,e.cell.isStatic?((0,i.wg)(),(0,i.iD)(i.HY,{key:0},[(0,i.Uk)((0,l.zw)(e.cell.value),1)],64)):((0,i.wg)(),(0,i.iD)("span",ie,(0,l.zw)(e.cell.value),1))],64)):((0,i.wg)(),(0,i.iD)("div",le,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.notes,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"note"},(0,l.zw)(e?t+1:""),1)))),128))]))],2)}var ne=s(10098);const oe=(0,i.aZ)({name:"SudokuCell",emits:["select","update"],props:{puzzle:{type:ee,required:!0},cell:{type:J,required:!0},isSelected:{type:Boolean,default:!1},isSquareSelected:{type:Boolean,default:!1},isRowSelected:{type:Boolean,default:!1},isColumnSelected:{type:Boolean,default:!1},isValueSelected:{type:Boolean,default:!1},size:{type:String,default:"1.0em"}},setup(){const e=(0,ne.F)();return{settings:e}},methods:{onClick(){this.isSelected||this.$emit("select")}},computed:{classObject(){return{static:this.cell.isStatic,selected:this.isSelected,"row-selected":this.isRowSelected,"column-selected":this.isColumnSelected,"square-selected":this.isSquareSelected,"value-selected":this.isValueSelected,error:this.settings.showErrors&&this.isError}},boardSize(){return Q.SIZE},isError(){return this.cell.hasValue()&&this.cell.value!==this.puzzle.getSolutionValue({position:this.cell.position})},notes(){return Array(this.boardSize).fill(null).map(((e,t)=>this.cell.notes.hasValue(t+1)))}},watch:{"cell.value":{handler(e,t){this.$emit("update",e,t)},immediate:!0}}}),re=()=>{(0,a.sj)((e=>({a48aef4c:e.size})))},ue=oe.setup;oe.setup=ue?(e,t)=>(re(),ue(e,t)):re;const ce=oe;var de=s(11639);const he=(0,de.Z)(ce,[["render",ae],["__scopeId","data-v-910ae26c"]]),me=he,ve=(0,i.aZ)({components:{SudokuCell:me},name:"SodukuBoard",props:{puzzle:{type:ee,required:!0},size:{type:String,default:"1.0em"}},emits:["cellSelected","cellUpdated"],data(){return{selectedCellId:null}},methods:{onSelectCell(e){this.selectedCellId=e,this.$emit("cellSelected",e)},getSquareCells(e){return Array(Q.SIZE).fill(null).map(((t,s)=>{const[i,l]=Q.squares[e].get(s);return this.puzzle.getCell({x:i,y:l})}))}},computed:{boardSize(){return Q.SIZE},selectedCellIndex(){return this.puzzle.cells.findIndex((e=>e.id===this.selectedCellId))},selectedCell(){return this.selectedCellIndex>-1?this.puzzle.cells[this.selectedCellIndex]:null}}}),pe=(0,de.Z)(ve,[["render",p],["__scopeId","data-v-77b833e9"]]),ge=pe,fe={class:"text-subtitle2"},ye={class:"text-subtitle2"};function we(e,t,s,a,n,o){const r=(0,i.up)("q-item-label"),u=(0,i.up)("q-item-section"),c=(0,i.up)("q-toggle"),d=(0,i.up)("q-item"),h=(0,i.up)("q-list"),m=(0,i.up)("q-card-section"),v=(0,i.up)("q-separator"),p=(0,i.up)("q-btn"),g=(0,i.up)("q-card-actions"),f=(0,i.up)("q-card"),y=(0,i.up)("q-dialog"),w=(0,i.Q2)("ripple"),S=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.j4)(y,{ref:"dialog",onHide:e.onDialogHide},{default:(0,i.w5)((()=>[(0,i.Wm)(f,{style:{width:"80vw"}},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{class:"q-pb-sm",header:""},{default:(0,i.w5)((()=>[(0,i.Uk)("Options")])),_:1}),(0,i.Wm)(m,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{style:{"font-size":"1.2em"}},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.settingsToggles,(e=>(0,i.wy)(((0,i.wg)(),(0,i.j4)(d,{class:"text-body1",clickable:"",key:e.name,onClick:()=>e.prop.value=!e.prop.value},{default:(0,i.w5)((()=>[(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.name),1)])),_:2},1024),(0,i.Wm)(u,{side:""},{default:(0,i.w5)((()=>[(0,i.Wm)(c,{color:"primary",size:"md",modelValue:e.prop.value,"onUpdate:modelValue":t=>e.prop.value=t,"checked-icon":"check","unchecked-icon":"clear"},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1032,["onClick"])),[[w]]))),128))])),_:1})])),_:1}),(0,i.Wm)(v),(0,i.Wm)(m,null,{default:(0,i.w5)((()=>[(0,i._)("div",fe,"Current level: "+(0,l.zw)(e.currentLevel),1),(0,i._)("div",ye,"Difficulty: "+(0,l.zw)(e.difficulty.name),1)])),_:1}),(0,i.Wm)(v),(0,i.Wm)(m,{class:"q-gutter-y-sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(p,{label:"Clear data",flat:"",color:"negative",class:"full-width",onClick:e.clearCache},null,8,["onClick"]),(0,i.Wm)(p,{label:"Retry level",flat:"",color:"negative",class:"full-width",onClick:e.onResetGame},null,8,["onClick"]),(0,i.Wm)(p,{label:"New level",flat:"",color:"primary",class:"full-width",onClick:e.onNewGame},null,8,["onClick"]),(0,i.Wm)(p,{label:"History",flat:"",color:"primary",class:"full-width",onClick:e.showHistory},null,8,["onClick"])])),_:1}),(0,i.Wm)(v),(0,i.Wm)(g,{align:"right"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(p,{flat:"",color:"primary",label:"Close"},null,512),[[S]])])),_:1})])),_:1})])),_:1},8,["onHide"])}const Se={style:{display:"flex","flex-direction":"row","flex-wrap":"nowrap","align-items":"center",width:"100%",height:"40px","font-size":"1.4em"}};function Ce(e,t,s,a,n,o){const r=(0,i.up)("q-input"),u=(0,i.up)("q-card-section"),c=(0,i.up)("q-space"),d=(0,i.up)("difficulty-rating"),h=(0,i.up)("q-btn"),m=(0,i.up)("q-card"),v=(0,i.up)("q-dialog");return(0,i.wg)(),(0,i.j4)(v,{ref:"dialog",onHide:o.onDialogHide},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{class:"q-dialog-plugin"},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{class:"text-h6"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Level "),(0,i.Wm)(r,{modelValue:a.levelNumber,"onUpdate:modelValue":t[0]||(t[0]=e=>a.levelNumber=e),mask:"##########","input-style":"text-align: center; font-size: 2em",rules:[e=>parseInt(e).toString()===e&&parseInt(e)<4294967296]},null,8,["modelValue","rules"])])),_:1}),(0,i.Wm)(u,{class:"text-h6"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Niveau ")])),_:1}),(0,i.Wm)(u,{class:"q-gutter-y-md"},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(a.Difficulty,(e=>((0,i.wg)(),(0,i.j4)(h,{key:e.level,color:"primary",outline:"",size:"sm",align:"left",class:"full-width",onClick:()=>o.onOKClick(e)},{default:(0,i.w5)((()=>[(0,i._)("div",Se,[(0,i._)("span",null,(0,l.zw)(e.name),1),(0,i.Wm)(c),(0,i.Wm)(d,{size:"sm",level:e.level},null,8,["level"])])])),_:2},1032,["onClick"])))),128))])),_:1}),(0,i.Wm)(u,null,{default:(0,i.w5)((()=>[(0,i.Wm)(h,{label:"Cancel",class:"full-width",color:"negative",onClick:o.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}var xe=s(60499);const _e=JSON.parse('[{"name":"Easier Than Easy","cells":9,"level":0,"logic":true},{"name":"Easy","cells":16,"level":1,"logic":true},{"name":"Novice","cells":24,"level":2,"logic":true},{"name":"Medium","cells":32,"level":3,"logic":true},{"name":"Intermediate","cells":40,"level":4,"logic":true},{"name":"Hard","cells":48,"level":5,"logic":true},{"name":"Difficult","cells":56,"level":6,"logic":false},{"name":"Expert","cells":64,"level":7,"logic":true},{"name":"☠️","cells":64,"level":8,"logic":false}]'),be={style:{display:"flex","flex-direction":"row","align-items":"center"}};function ze(e,t,s,l,a,n){const o=(0,i.up)("q-icon");return(0,i.wg)(),(0,i.iD)("div",be,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.starCount,(t=>((0,i.wg)(),(0,i.j4)(o,{key:t,size:e.size,name:"star",color:"yellow"},null,8,["size"])))),128))])}const ke=(0,i.aZ)({name:"DifficultyRating",props:{level:{type:Number,required:!0},size:{type:String,default:""}},computed:{starCount(){return this.level+1}}});var Ee=s(22857),qe=s(69984),Ne=s.n(qe);const Ie=(0,de.Z)(ke,[["render",ze]]),Ze=Ie;function Me(e,t){const s=parseInt(e);return isNaN(s)?t:s}Ne()(ke,"components",{QIcon:Ee.Z});const Be={components:{DifficultyRating:Ze},name:"NewLevelDialog",props:{},emits:["ok","hide"],setup(){return{Difficulty:_e,levelNumber:(0,xe.iH)(Math.floor(4294967296*Math.random()))}},methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onOKClick(e){const t=Me(this.levelNumber,Math.floor(4294967296*Math.random()));this.$emit("ok",{difficultyLevel:e.level,seed:t}),this.hide()},onCancelClick(){this.hide()}}};var We=s(7657),De=s(44458),Ve=s(63190),He=s(31169),Le=s(24455),Oe=s(90136);const Ue=(0,de.Z)(Be,[["render",Ce]]),Ae=Ue;Ne()(Be,"components",{QDialog:We.Z,QCard:De.Z,QCardSection:Ve.Z,QInput:He.Z,QBtn:Le.Z,QSpace:Oe.Z});const $e={class:"text-center"},Qe={class:"text-left"},Re={class:"row items-center text-left"},Te={class:"text-left"},je={key:1,class:"text-body1"};function Ke(e,t,s,a,n,o){const r=(0,i.up)("q-card-section"),u=(0,i.up)("difficulty-rating"),c=(0,i.up)("q-icon"),d=(0,i.up)("q-markup-table"),h=(0,i.up)("q-btn"),m=(0,i.up)("q-card"),v=(0,i.up)("q-dialog");return(0,i.wg)(),(0,i.j4)(v,{ref:"dialog",onHide:o.onDialogHide,persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(m,{class:"q-dialog-plugin q-pa-sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{class:"text-h4"},{default:(0,i.w5)((()=>[(0,i.Uk)(" Victories ")])),_:1}),(0,i.Wm)(r,{class:"q-my-md text-h6"},{default:(0,i.w5)((()=>[s.victories.length?((0,i.wg)(),(0,i.j4)(d,{key:0,style:{"max-height":"60vh"},separator:"horizontal",flat:"",bordered:"",class:"text-subtitle2"},{default:(0,i.w5)((()=>[(0,i._)("tbody",null,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(s.victories,((e,t)=>((0,i.wg)(),(0,i.iD)("tr",{key:t},[(0,i._)("td",$e,[(0,i.Wm)(u,{level:e.difficultyLevel},null,8,["level"])]),(0,i._)("td",Qe,"#"+(0,l.zw)(e.level),1),(0,i._)("td",Re,[(0,i.Wm)(c,{name:"o_lightbulb",outline:""}),(0,i.Uk)(" "+(0,l.zw)(e.hintCount),1)]),(0,i._)("td",Te,(0,l.zw)(this.displayTime(e.time)),1)])))),128))])])),_:1})):((0,i.wg)(),(0,i.iD)("div",je,"No items in this list"))])),_:1}),(0,i.Wm)(r,{align:"right"},{default:(0,i.w5)((()=>[(0,i.Wm)(h,{label:"Close",outline:"",color:"primary",onClick:o.hide},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const Fe={components:{DifficultyRating:Ze},name:"VictoryHistoryScreen",props:{victories:{type:Array,required:!0}},emits:["ok","hide"],methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},displayTime(e){const t=e%60,s=Math.floor(e/60);return s.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")}}};var Ye=s(66933);const Pe=(0,de.Z)(Fe,[["render",Ke]]),Ge=Pe;Ne()(Fe,"components",{QDialog:We.Z,QCard:De.Z,QCardSection:Ve.Z,QMarkupTable:Ye.Z,QIcon:Ee.Z,QBtn:Le.Z});const Je=(0,i.aZ)({name:"SettingsScreen",props:{currentLevel:{type:Number,required:!0},difficulty:{type:Object,required:!0}},setup(){const e=(0,ne.F)(),t=[{name:"Display time",prop:(0,i.Fl)({get:()=>e.showTime,set:t=>e.showTime=t})},{name:"Highlight errors",prop:(0,i.Fl)({get:()=>e.showErrors,set:t=>e.showErrors=t})},{name:"Allow hints",prop:(0,i.Fl)({get:()=>e.showHints,set:t=>e.showHints=t})},{name:"Mark illegal moves",prop:(0,i.Fl)({get:()=>e.markImpossibleNumbers,set:t=>e.markImpossibleNumbers=t})},{name:"Place numbers on select",prop:(0,i.Fl)({get:()=>e.placeNumbersOnSelect,set:t=>e.placeNumbersOnSelect=t})}];return{settings:e,settingsToggles:t}},emits:["ok","hide"],methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},onDialogCancel(){this.hide()},onDialogOK(e){this.$emit("ok",e),this.hide()},confirm(e){return new Promise(((t,s)=>{this.$q.dialog({title:"Warning",message:e,cancel:!0,persistent:!0,ok:{label:"Continue",color:"negative"}}).onOk((()=>t(!0))).onCancel((()=>s(!1)))}))},async onResetGame(){const e=await this.confirm("Are you sure? You cannot reverse this action.");e&&this.onDialogOK({name:"reset-level",data:{}})},async clearCache(){const e=await this.confirm("Are you sure? This will remove your current save game and the victory history. You cannot reverse this action.");e&&(this.$q.localStorage.clear(),location.reload())},onNewGame(){this.$q.dialog({component:Ae}).onOk((e=>{this.onDialogOK({name:"new-level",data:{seed:e.seed,difficultyLevel:e.difficultyLevel}})}))},showHistory(){this.$q.dialog({component:Ge,componentProps:{victories:(this.$q.localStorage.getItem("victories")?.data??[]).reverse()}})}}});var Xe=s(33115),et=s(13246),tt=s(490),st=s(76749),it=s(23175),lt=s(50926),at=s(11821),nt=s(51136),ot=s(62146);const rt=(0,de.Z)(Je,[["render",we]]),ut=rt;Ne()(Je,"components",{QDialog:We.Z,QCard:De.Z,QItemLabel:Xe.Z,QCardSection:Ve.Z,QList:et.Z,QItem:tt.Z,QItemSection:st.Z,QToggle:it.Z,QSeparator:lt.Z,QBtn:Le.Z,QCardActions:at.Z}),Ne()(Je,"directives",{Ripple:nt.Z,ClosePopup:ot.Z});const ct={id:"number-bar"},dt={style:{position:"relative",display:"flex","justify-content":"center","align-items":"center","margin-top":"-8px","margin-bottom":"4px"}},ht={style:{height:"100%",display:"flex","flex-direction":"row","justify-content":"center","align-items":"center"}},mt={key:0,class:"number-btn"};function vt(e,t,s,a,n,o){const r=(0,i.up)("q-icon"),u=(0,i.up)("q-btn");return(0,i.wg)(),(0,i.iD)("div",ct,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(Math.ceil(e.size/2),(t=>((0,i.wg)(),(0,i.iD)("div",{key:t},[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.columnNumbers(t),(t=>((0,i.wg)(),(0,i.j4)(u,{key:t,size:"xl",color:"white",outline:"",padding:"none",class:"number-btn",onClick:()=>e.$emit("click",t)},{default:(0,i.w5)((()=>[(0,i._)("div",{style:{display:"flex","flex-direction":"column",height:"100%","justify-content":"flex-start",width:"100%","padding-bottom":"10px","padding-top":"10px"},class:(0,l.C_)(e.classObject(t))},[(0,i._)("div",dt,(0,l.zw)(t),1),(0,i._)("div",ht,[(0,i.Wm)(r,{name:"adjust",class:"number-icon active-icon q-pa-none q-ma-none",padding:"none",size:"sm"}),(0,i.Wm)(r,{name:"done_all",class:"number-icon completed-icon q-pa-none q-ma-none",padding:"none",size:"sm"})])],2)])),_:2},1032,["onClick"])))),128)),1===e.columnNumbers(t).length?((0,i.wg)(),(0,i.iD)("div",mt)):(0,i.kq)("",!0)])))),128))])}const pt=(0,i.aZ)({name:"NumberBar",props:{size:{type:Number,required:!0},activeNumbers:{type:Array,default:()=>[]},inactiveNumbers:{type:Array,default:()=>[]},completedNumbers:{type:Array,default:()=>[]}},emits:["click"],methods:{classObject(e){return console.log(this.completedNumbers),{"active-number":this.activeNumbers.includes(e),"inactive-number":this.inactiveNumbers.includes(e),"completed-number":this.completedNumbers.includes(e)}},columnNumbers(e){const t=e,s=e+Math.ceil(this.size/2);return s>this.size?[t]:[t,s]}}}),gt=(0,de.Z)(pt,[["render",vt],["__scopeId","data-v-6d07f233"]]),ft=gt;Ne()(pt,"components",{QBtn:Le.Z,QIcon:Ee.Z});const yt={class:"text-h6 row items-center"},wt={class:"q-ml-sm"},St={class:"text-h6 row items-center"},Ct={class:"q-ml-sm"},xt={class:"text-h6 row items-center"},_t={class:"q-ml-sm"},bt={class:"text-h6 row items-center"},zt={class:"q-ml-sm"};function kt(e,t,s,a,n,o){const r=(0,i.up)("q-card-section"),u=(0,i.up)("difficulty-rating"),c=(0,i.up)("q-btn"),d=(0,i.up)("q-card"),h=(0,i.up)("q-dialog");return(0,i.wg)(),(0,i.j4)(h,{ref:"dialog",onHide:o.onDialogHide,persistent:""},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{class:"q-dialog-plugin q-pa-sm"},{default:(0,i.w5)((()=>[(0,i.Wm)(r,{class:"text-h2"},{default:(0,i.w5)((()=>[(0,i.Uk)(" You Won! ")])),_:1}),(0,i.Wm)(r,{class:"q-gutter-y-md text-h6"},{default:(0,i.w5)((()=>[(0,i._)("div",yt,[(0,i.Uk)(" Difficulty: "),(0,i._)("span",wt,[(0,i.Wm)(u,{level:s.puzzle.difficultyLevel},null,8,["level"])])]),(0,i._)("div",St,[(0,i.Uk)(" Hints: "),(0,i._)("span",Ct,(0,l.zw)(s.hintCount),1)]),(0,i._)("div",xt,[(0,i.Uk)(" Time Taken: "),(0,i._)("span",_t,(0,l.zw)(o.displayTime),1)]),(0,i._)("div",bt,[(0,i.Uk)(" Level: "),(0,i._)("span",zt,"#"+(0,l.zw)(s.puzzle.seed),1)])])),_:1}),(0,i.Wm)(r,null,{default:(0,i.w5)((()=>[(0,i.Wm)(c,{label:"Play Another",class:"full-width",size:"lg",color:"primary",onClick:o.nextLevel},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}const Et={name:"VictoryScreen",components:{DifficultyRating:Ze},props:{puzzle:{type:ee,required:!0},time:{type:Number,required:!0},hintCount:{type:Number,required:!0}},emits:["ok","hide"],methods:{show(){this.$refs.dialog.show()},hide(){this.$refs.dialog.hide()},onDialogHide(){this.$emit("hide")},nextLevel(){this.$q.dialog({component:Ae}).onOk((e=>{this.$emit("ok",e),this.hide()}))}},computed:{displayTime(){const e=this.time%60,t=Math.floor(this.time/60);return t.toString().padStart(2,"0")+":"+e.toString().padStart(2,"0")}}},qt=(0,de.Z)(Et,[["render",kt]]),Nt=qt;Ne()(Et,"components",{QDialog:We.Z,QCard:De.Z,QCardSection:Ve.Z,QBtn:Le.Z});class It{on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)}off(e,t){this.events[e]&&(this.events[e]=this.events[e].filter((e=>e!==t)))}dispatch(e,t){this.events[e]&&this.events[e].forEach((e=>e(t)))}constructor(){z()(this,"events",void 0),this.events={}}}new It;class Zt{static serialize(e){return e.data.map((e=>JSON.stringify(e)))}static deserialize(e,t){return e.clear(),t.forEach((t=>{const s=JSON.parse(t);e.data.push(s)})),e}clear(){this.data.length=0}rollBack(){return 0===this.data.length?null:this.data.pop()}store(e){if(Array.isArray(e)||(e=[e]),0===e.length)return;const t=e.map(Y()(Zt,Zt,Mt));this.data.push(t)}get size(){return this.data.length}constructor(){z()(this,"data",void 0),this.data=[]}}function Mt(e){return JSON.parse(JSON.stringify(e))}var Bt=s(83457),Wt=s(34962);function Dt(e,t){const s=parseInt(e);return isNaN(s)?t:s}class Vt{dispatchUpdate(){this.eventBus.dispatch("update",{time:this.time})}updateTimer(){this.paused||(this.time++,this.dispatchUpdate())}set(e){this.time=Dt(e,0),this.dispatchUpdate()}start(){(0,i.YP)((()=>Wt.Z.appVisible),(e=>{e?this.__timer=window.setInterval(this.updateTimer.bind(this),1e3):window.clearInterval(this.__timer)}),{immediate:!0})}constructor(e){z()(this,"time",void 0),z()(this,"paused",void 0),z()(this,"eventBus",void 0),z()(this,"__timer",0),this.eventBus=new It,this.paused=!1,this.time=Dt(e,0)}}var Ht=s(37628),Lt=s.n(Ht),Ot=s(40559),Ut=s.n(Ot);s(58672);class At{static getOptionCount(e){for(var t=0,s=0;s<Q.SIZE;s++)e.get(s)&&t++;return t}static getOptionValues(e){const t=[];for(var s=0;s<Q.SIZE;s++)e.get(s)&&t.push(s+1);return t}getCellWithLeastOptions(){for(var e=Q.SIZE+1,t=null,s=0;s<Q.SIZE;s++)for(var i=0;i<Q.SIZE;i++){if(this.board.getCell(i,s))continue;const l=this.getNotesForCell(i,s),a=At.getOptionCount(l);if(2===a)return[i,s];a<e&&(t=[i,s],e=a)}return t}getNotesForCell(e,t){return this.cellnotes[e+t*Q.SIZE]}setup(){for(var e=0;e<Q.SIZE;e++)for(var t=0;t<Q.SIZE;t++)this.cellnotes.push(Y()(At,At,$t).call(At,this.board,t,e))}clone(e){const t=new At(e);return t.cellnotes=this.cellnotes.map((e=>e.clone())),t}static fromBoard(e){const t=new At(e);return t.setup(),t}constructor(e){z()(this,"cellnotes",void 0),this.id=q.getId(),this.cellnotes=[],this.board=e}}function $t(e,t,s){const i=new V;if(e.getCell(t,s))return i;for(var l=0;l<Q.SIZE;l++){const a=[Q.getRow(t,s),Q.getColumn(t,s),Q.getSquare(t,s)],n=l+1,o=a.reduce(((t,s)=>t&&!H.includesValue(e,s,n)),!0);i.set(l,o)}return i}function Qt(e){return new Promise((t=>setTimeout((()=>t(e())),0)))}var Rt=new WeakMap;class Tt{constructor(){w()(this,Rt,{writable:!0,value:0})}async getResult(e){var t;return C()(this,Rt,(t=_()(this,Rt),t++,t)),_()(this,Rt)>50?(C()(this,Rt,0),Qt(e)):new Promise((t=>t(e())))}}function jt(e){return e.find((e=>void 0!==e))}const Kt=17;async function Ft(e,t,s){s=!0===s;const i=new B(t),l=K.randomSkeleton(i),a=new Xt,n=jt(await a.getSolutions(l,1,i));if(!n)throw new Error("Error creating new solution");const o=Array(Q.SIZE).fill(null).map(((e,t)=>[...Array(Q.SIZE).keys()].map((e=>[e,t])))).reduce(((e,t)=>e.concat(t)),[]);D(o,i);var r=0;const u=n.duplicate();for(var c=0;c<o.length&&r+Kt<Q.CELL_COUNT;c++){const[t,l]=o[c],n=u.getCell(t,l);u.setCell(t,l,0);const d=await a.getSolutions(u,2,i,s);if(1!==d.length)u.setCell(t,l,n);else if(r++,r>=e)break}return[n,u,i.seed]}class Yt extends Error{constructor(e){super(e),this.name="SolutionError"}}var Pt=new WeakSet,Gt=new WeakSet,Jt=new WeakSet;class Xt{constructor(e){Lt()(this,Jt),Lt()(this,Gt),Lt()(this,Pt),z()(this,"board",void 0),this.id=q.getId(),this.board=e}boardCompare(e,t){const s=Q.CELL_COUNT;for(var i=0;i<s;i++){e.cells.get(i),t.cells.get(i)}return!0}notebookCompare(e,t){const s=Q.CELL_COUNT;for(var i=0;i<s;i++){const s=At.getOptionValues(e.cellnotes[i]),l=At.getOptionValues(t.cellnotes[i]),a=s.reduce(((e,t,s)=>{const i=l[s];return e&&t===i}),!0);if(!a)return!1}return!0}async getSolutions(e,t,s,i,l,a,n,o){a=!1!==a,t=t||1,s=s??new B,i=!0===i,n=n??0,o=o||new Tt;const r=a?e.clone():e,u=a&&l?l.clone(r):At.fromBoard(r);try{while(Ut()(this,Jt,ss).call(this,u,s));}catch(g){if(g instanceof Yt)return console.debug(g.message),[];throw g}if(i||r.isFinished())return r.isValid()?[r]:[];const[c,d]=u.getCellWithLeastOptions(),h=u.getNotesForCell(c,d),m=At.getOptionValues(h);for(var v=[],p=0;p<m.length;p++){const e=m[p],l=r.clone(),a=u.clone(l);Ut()(this,Gt,ts).call(this,a,c,d,e);const h=await o.getResult((()=>this.getSolutions(l,t,s,i,a,!1,n+v.length,o)));if(v=v.concat(h),v.length+n>=t)return v}return v}}function es(e,t,s){if(e.board.getCell(t,s))return!1;const i=e.getNotesForCell(t,s),l=At.getOptionValues(i);if(l.length>1)return!1;if(0===l.length)throw new Yt(`Cell ${t}, ${s} cannot be filled`);return Ut()(this,Gt,ts).call(this,e,t,s,l[0]),!0}function ts(e,t,s,i){e.board.setCell(t,s,i);const l=[Q.getRow(t,s),Q.getColumn(t,s),Q.getSquare(t,s)];l.forEach((t=>{for(var s=0;s<Q.SIZE;s++){const[l,a]=t.get(s),n=e.getNotesForCell(l,a);n.set(i-1,!1),Ut()(this,Pt,es).call(this,e,l,a)}}))}function ss(e,t){var s=!1;const i=Array(Q.SIZE).fill(null).map(((t,s)=>[...Array(Q.SIZE).keys()].filter((t=>!e.board.getCell(t,s))).map((e=>[e,s])))).reduce(((e,t)=>e.concat(t)),[]);return D(i,t),i.forEach((([t,i])=>{Ut()(this,Pt,es).call(this,e,t,i)&&(s=!0)})),s}const is=JSON.parse('{"cells":[{"value":9,"x":0,"y":0,"notes":[],"static":true},{"value":1,"x":1,"y":0,"notes":[],"static":true},{"value":5,"x":2,"y":0,"notes":[],"static":true},{"value":7,"x":3,"y":0,"notes":[],"static":true},{"value":2,"x":4,"y":0,"notes":[],"static":true},{"value":4,"x":5,"y":0,"notes":[],"static":true},{"value":6,"x":6,"y":0,"notes":[],"static":true},{"value":3,"x":7,"y":0,"notes":[],"static":true},{"value":8,"x":8,"y":0,"notes":[],"static":true},{"value":3,"x":0,"y":1,"notes":[],"static":true},{"value":4,"x":1,"y":1,"notes":[],"static":true},{"value":7,"x":2,"y":1,"notes":[],"static":true},{"value":8,"x":3,"y":1,"notes":[],"static":true},{"value":6,"x":4,"y":1,"notes":[],"static":true},{"value":5,"x":5,"y":1,"notes":[],"static":true},{"value":9,"x":6,"y":1,"notes":[],"static":true},{"value":2,"x":7,"y":1,"notes":[],"static":true},{"value":1,"x":8,"y":1,"notes":[],"static":true},{"value":2,"x":0,"y":2,"notes":[],"static":true},{"value":0,"x":1,"y":2,"notes":[],"static":false},{"value":0,"x":2,"y":2,"notes":[],"static":false},{"value":3,"x":3,"y":2,"notes":[],"static":true},{"value":9,"x":4,"y":2,"notes":[],"static":true},{"value":1,"x":5,"y":2,"notes":[],"static":true},{"value":0,"x":6,"y":2,"notes":[],"static":false},{"value":4,"x":7,"y":2,"notes":[],"static":true},{"value":7,"x":8,"y":2,"notes":[],"static":true},{"value":5,"x":0,"y":3,"notes":[],"static":true},{"value":8,"x":1,"y":3,"notes":[],"static":true},{"value":4,"x":2,"y":3,"notes":[],"static":true},{"value":2,"x":3,"y":3,"notes":[],"static":true},{"value":7,"x":4,"y":3,"notes":[],"static":true},{"value":3,"x":5,"y":3,"notes":[],"static":true},{"value":1,"x":6,"y":3,"notes":[],"static":true},{"value":0,"x":7,"y":3,"notes":[],"static":false},{"value":9,"x":8,"y":3,"notes":[],"static":true},{"value":6,"x":0,"y":4,"notes":[],"static":true},{"value":2,"x":1,"y":4,"notes":[],"static":true},{"value":1,"x":2,"y":4,"notes":[],"static":true},{"value":5,"x":3,"y":4,"notes":[],"static":true},{"value":4,"x":4,"y":4,"notes":[],"static":true},{"value":9,"x":5,"y":4,"notes":[],"static":true},{"value":7,"x":6,"y":4,"notes":[],"static":true},{"value":8,"x":7,"y":4,"notes":[],"static":true},{"value":3,"x":8,"y":4,"notes":[],"static":true},{"value":0,"x":0,"y":5,"notes":[],"static":false},{"value":0,"x":1,"y":5,"notes":[],"static":false},{"value":9,"x":2,"y":5,"notes":[],"static":true},{"value":1,"x":3,"y":5,"notes":[],"static":true},{"value":0,"x":4,"y":5,"notes":[],"static":false},{"value":6,"x":5,"y":5,"notes":[],"static":true},{"value":2,"x":6,"y":5,"notes":[],"static":true},{"value":5,"x":7,"y":5,"notes":[],"static":true},{"value":4,"x":8,"y":5,"notes":[],"static":true},{"value":1,"x":0,"y":6,"notes":[],"static":true},{"value":7,"x":1,"y":6,"notes":[],"static":true},{"value":3,"x":2,"y":6,"notes":[],"static":true},{"value":4,"x":3,"y":6,"notes":[],"static":true},{"value":5,"x":4,"y":6,"notes":[],"static":true},{"value":2,"x":5,"y":6,"notes":[],"static":true},{"value":8,"x":6,"y":6,"notes":[],"static":true},{"value":9,"x":7,"y":6,"notes":[],"static":true},{"value":0,"x":8,"y":6,"notes":[],"static":false},{"value":0,"x":0,"y":7,"notes":[],"static":false},{"value":9,"x":1,"y":7,"notes":[],"static":true},{"value":2,"x":2,"y":7,"notes":[],"static":true},{"value":6,"x":3,"y":7,"notes":[],"static":true},{"value":3,"x":4,"y":7,"notes":[],"static":true},{"value":7,"x":5,"y":7,"notes":[],"static":true},{"value":4,"x":6,"y":7,"notes":[],"static":true},{"value":1,"x":7,"y":7,"notes":[],"static":true},{"value":5,"x":8,"y":7,"notes":[],"static":true},{"value":4,"x":0,"y":8,"notes":[],"static":true},{"value":5,"x":1,"y":8,"notes":[],"static":true},{"value":6,"x":2,"y":8,"notes":[],"static":true},{"value":9,"x":3,"y":8,"notes":[],"static":true},{"value":1,"x":4,"y":8,"notes":[],"static":true},{"value":8,"x":5,"y":8,"notes":[],"static":true},{"value":3,"x":6,"y":8,"notes":[],"static":true},{"value":7,"x":7,"y":8,"notes":[],"static":true},{"value":2,"x":8,"y":8,"notes":[],"static":true}],"seed":1,"solution":[9,1,5,7,2,4,6,3,8,3,4,7,8,6,5,9,2,1,2,6,8,3,9,1,5,4,7,5,8,4,2,7,3,1,6,9,6,2,1,5,4,9,7,8,3,7,3,9,1,8,6,2,5,4,1,7,3,4,5,2,8,9,6,8,9,2,6,3,7,4,1,5,4,5,6,9,1,8,3,7,2],"difficultyLevel":0}');class ls{static __initSaveManager(e){e.saveManager=new Bt.Z("game"),e.saveManager.states.push(new Bt.b("puzzle",(()=>ee.serialize(e.puzzle)),(t=>ee.deserialize(e.puzzle,t)),(()=>{ee.deserialize(e.puzzle,is)})),new Bt.b("time",(()=>e.timer.time),(t=>e.timer.set(t)),(()=>e.timer.set(0))),new Bt.b("hintCount",(()=>e.hintCount),(t=>e.hintCount=t),(()=>e.hintCount=0)),new Bt.b("memory",(()=>Zt.serialize(e.memory)),(t=>{Zt.deserialize(e.memory,t)}),(()=>e.memory.clear())))}__createMemoryState(e,t,{isNote:s,isHint:i}={}){return{cellId:e,value:t,isNote:!0===s,isHint:!0===i}}__saveMemoryState(e,t,{isNote:s,isHint:i}={}){const l=this.__createMemoryState(e,t,{isNote:s,isHint:i});this.memory.store(l)}__updateVictoryState(){const e=this.puzzle.cells.reduce(((e,t,s)=>e&&this.puzzle.solution[s]===t.value),!0);return!!e&&(this.eventBus.dispatch("victory",{}),!0)}__ensureCanEditCell(e){return e?!e.isStatic||(this.__dispatchError("Cannot edit this cell."),!1):(this.__dispatchError("No cell selected."),!1)}__dispatchError(e){this.eventBus.dispatch("error",{message:e})}placeNum(e,t,{isHint:s=!1}={}){const i=this.puzzle.findCellById(e);if(this.__ensureCanEditCell(i)){if(this.__saveMemoryState(e,i.value,{isNote:!1,isHint:s}),i.value===t)i.value=0;else if(i.value=t,this.__updateVictoryState())return;this.saveManager.save()}}placeNote(e,t){const s=this.puzzle.findCellById(e);this.__ensureCanEditCell(s)&&(s.hasValue()?this.__dispatchError("Cell already has a value."):(this.__saveMemoryState(e,s.notes.values,{isNote:!0,isHint:!1}),s.notes.swapValue(t),this.saveManager.save()))}clearCell(e){const t=this.puzzle.findCellById(e);this.__ensureCanEditCell(t)&&(t.hasValue()||t.notes.values.length)&&(t.hasValue()?(this.__saveMemoryState(e,t.value,{isNote:!1,isHint:!1}),t.value=0):(this.__saveMemoryState(e,t.notes.values,{isNote:!0,isHint:!1}),t.notes.clear()),this.saveManager.save())}undo(){if(!this.memory.size)return;const e=this.memory.rollBack();e.forEach((e=>{const t=this.puzzle.findCellById(e.cellId),s=e.value;switch(e.isNote){case!1:t.value=s;break;case!0:t.notes.set(s);break}e.isHint&&this.hintCount--})),this.saveManager.save()}hint(){const e=this.puzzle.cells.find((e=>!e.hasValue()));if(!e)return;const t=this.puzzle.solution[ee.toIndex({position:e.position})];this.__saveMemoryState(e.id,0,{isNote:!1,isHint:!0}),e.value=t,this.hintCount++,this.__updateVictoryState()||this.saveManager.save()}resetGameState(){this.timer.set(0),this.memory.clear(),this.hintCount=0,this.timer.paused=!1,this.saveManager.save(),this.eventBus.dispatch("start-level",{puzzle:this.puzzle})}resetLevel(){this.puzzle.cells.forEach((e=>{e.isStatic||(e.value=0,e.notes.clear())})),this.resetGameState(),this.saveManager.save()}async newLevel(e,t){const s=_e.find((t=>t.level===e))??_e[0],[i,l,a]=await Ft(s.cells,t);ee.fromBoard(this.puzzle,l,i,a),this.puzzle.difficultyLevel=e,this.resetGameState(),this.saveManager.save()}constructor(){z()(this,"puzzle",void 0),z()(this,"saveManager",void 0),z()(this,"memory",void 0),z()(this,"timer",void 0),z()(this,"hintCount",void 0),z()(this,"eventBus",void 0),this.eventBus=new It,this.memory=new Zt,this.timer=new Vt,this.puzzle=new ee,this.hintCount=0,ls.__initSaveManager(this)}}const as=(0,i.aZ)({components:{SudokuBoard:ge,NumberBar:ft,DifficultyRating:Ze},name:"IndexPage",setup(){const e=(0,ne.F)(),t=(0,xe.qj)(new ls);return{settings:e,gameState:t,renderKey:(0,xe.iH)(0)}},created(){this.gameState.eventBus.on("victory",(e=>{this.showVictory()})),this.gameState.eventBus.on("error",(e=>{this.showError(e.message)})),this.gameState.saveManager.load(),this.gameState.eventBus.dispatch("start-level"),this.gameState.timer.start()},data(){return{noteMode:!1,selectedCellId:null,numCount:Array(Q.SIZE).fill(0)}},methods:{showError(e){this.$q.notify({message:e,group:!1,type:"negative",timeout:1e3,actions:[{icon:"close",color:"white"}]})},showVictory(){const e=this.gameState.timer.time,t=this.$q.localStorage.getItem("victories")?.data??[];t.push({level:this.gameState.puzzle.seed,time:e,hintCount:this.gameState.hintCount,difficultyLevel:this.gameState.puzzle.difficultyLevel}),this.$q.localStorage.set("victories",{data:t}),this.$q.dialog({component:Nt,componentProps:{puzzle:this.gameState.puzzle,time:e,hintCount:this.gameState.hintCount}}).onOk((async e=>{await this.generateLevel(e.difficultyLevel,e.seed)}))},async generateLevel(e,t){this.$q.loading.show({message:"Generating level...",delay:1}),await this.gameState.newLevel(e,t),this.$q.loading.hide()},showSettings(){this.gameState.timer.paused=!0,this.$q.dialog({component:ut,componentProps:{currentLevel:this.gameState.puzzle.seed,difficulty:this.gameDifficulty}}).onOk((async e=>{switch(e.name){case"new-level":await this.generateLevel(e.data.difficultyLevel,e.data.seed);break;case"reset-level":this.gameState.resetLevel();break}})).onDismiss((()=>{this.gameState.timer.paused=!1}))},onTapNumber(e){this.placeNumber(e)},placeNumber(e){this.noteMode?this.gameState.placeNote(this.selectedCellId,e):this.gameState.placeNum(this.selectedCellId,e)},clearCell(){this.gameState.clearCell(this.selectedCellId)},hint(){this.gameState.hint()},cellSelected(e){this.selectedCellId=e},cellUpdated(e,t,s){t&&this.numCount[t-1]++,s&&this.numCount[s-1]--},undo(){this.gameState.undo()}},computed:{boardSize(){return Q.SIZE},selectedCell(){return this.gameState.puzzle.findCellById(this.selectedCellId)},activeNumbers(){return this.selectedCell?this.selectedCell.isStatic||this.selectedCell.value?[]:this.selectedCell.notes.values:[]},inactiveNumbers(){if(!this.settings.markImpossibleNumbers)return[];if(!this.selectedCell)return[];if(this.selectedCell.isStatic)return Array(this.boardSize).fill(null).map(((e,t)=>t+1));const e=(e,t)=>this.gameState.puzzle.getCell({x:e,y:t}).value,t=[this.selectedCell.row,this.selectedCell.column,this.selectedCell.square],s=t.map((t=>Array(this.boardSize).fill(null).map(((s,i)=>e(...t.get(i)))).filter((e=>e>0)))).reduce(((e,t)=>e.concat(t)),[]).filter(((e,t,s)=>s.indexOf(e)===t));return s},puzzleTime(){const e=this.gameState.timer.time,t=0+e%60,s=0+Math.floor(e/60);return s.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")},completedNumbers(){return this.numCount.map(((e,t)=>e>=Q.SIZE?t+1:null)).filter((e=>null!==e))},gameDifficulty(){return _e.find((e=>e.level===this.gameState.puzzle?.difficultyLevel))||_e[0]}}});var ns=s(69885);const os=(0,de.Z)(as,[["render",h],["__scopeId","data-v-5dc784b6"]]),rs=os;Ne()(as,"components",{QPage:ns.Z,QSpace:Oe.Z,QBtn:Le.Z,QToggle:it.Z})}}]);